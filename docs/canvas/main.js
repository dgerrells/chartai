var x0=Object.create;var{getPrototypeOf:d0,defineProperty:I0,getOwnPropertyNames:p0}=Object;var l0=Object.prototype.hasOwnProperty;var o0=($,q,Q)=>{Q=$!=null?x0(d0($)):{};let B=q||!$||!$.__esModule?I0(Q,"default",{value:$,enumerable:!0}):Q;for(let J of p0($))if(!l0.call(B,J))I0(B,J,{get:()=>$[J],enumerable:!0});return B};var i0=(($)=>typeof require!=="undefined"?require:typeof Proxy!=="undefined"?new Proxy($,{get:(q,Q)=>(typeof require!=="undefined"?require:q)[Q]}):$)(function($){if(typeof require!=="undefined")return require.apply(this,arguments);throw Error('Dynamic require of "'+$+'" is not supported')});var B0=[];function L0($){if(!B0.some((q)=>q.name===$.name))B0.push($)}class A{static instance=null;static MARGIN={left:55,right:10,top:8,bottom:45};static HOVER_MAX_DISTANCE_PX=50;static MIN_ZOOM=0.1;static MAX_ZOOM=1e7;static DEFAULT_LABEL_SIZE=12;static DEFAULT_FONT='-apple-system, BlinkMacSystemFont, "Segoe UI", system-ui, sans-serif';static resizeCanvas($,q,Q){let B=devicePixelRatio||1;if($.width=Math.round(q*B),$.height=Math.round(Q*B),$ instanceof HTMLCanvasElement)$.style.width=`${q}px`,$.style.height=`${Q}px`}worker=null;charts=new Map;chartIdCounter=0;_syncViews=!1;_isDark=!1;statsCallbacks=[];currentStats={fps:0,renderMs:0,total:0,active:0};visibilityObserver;resizeObserver;constructor(){this._isDark=document.documentElement.classList.contains("dark"),this.visibilityObserver=new IntersectionObserver(($)=>{for(let q of $){let Q=q.target.dataset.chartId;if(Q){let B=this.charts.get(Q);if(B){if(B.visible=q.isIntersecting,this.worker?.postMessage({type:"set-visibility",id:Q,visible:q.isIntersecting}),q.isIntersecting)this.drawChart(B)}}}},{threshold:0.01}),this.resizeObserver=new ResizeObserver(($)=>{for(let q of $){let Q=q.target.dataset.chartId;if(!Q)continue;let B=this.charts.get(Q);if(!B)continue;let{width:J,height:K}=q.contentRect;if(J<=0||K<=0)continue;B.width=J,B.height=K;let j=devicePixelRatio||1;this.worker?.postMessage({type:"resize",id:Q,width:Math.round(J*j),height:Math.round(K*j)}),A.resizeCanvas(B.backCanvas,J,K),A.resizeCanvas(B.axisCanvas,J,K),this.drawChart(B)}})}static getInstance(){if(!A.instance)A.instance=new A;return A.instance}get isDark(){return this._isDark}get syncViews(){return this._syncViews}async init(){if(this.worker)return!0;return new Promise(($)=>{import("./worker-inline.js").then(({WORKER_CODE:q})=>{let Q=new Blob([q],{type:"application/javascript"}),B=URL.createObjectURL(Q);this.worker=new Worker(B,{type:"module"}),this.setupWorkerHandlers($)}).catch(()=>{let q=new URL("./gpu-worker.js",import.meta.url);this.worker=new Worker(q,{type:"module"}),this.setupWorkerHandlers($)})})}setupWorkerHandlers($){if(!this.worker)return;this.worker.onmessage=(q)=>{let{type:Q,...B}=q.data;switch(Q){case"gpu-ready":$(!0);break;case"error":console.error("ChartManager GPU Error:",B.message),$(!1);break;case"stats":this.currentStats={fps:B.fps,renderMs:B.renderMs,total:B.totalCharts,active:B.activeCharts};for(let J of this.statsCallbacks)J(this.currentStats);break;case"bounds-update":{let J=this.charts.get(B.id);if(J)J.bounds={minX:B.minX,maxX:B.maxX,minY:B.minY,maxY:B.maxY},this.drawChart(J);break}default:break}},this.worker.onerror=(q)=>{console.error("ChartManager Worker Error:",q),$(!1)},this.worker.postMessage({type:"init",isDark:this._isDark})}create($){if(!this.worker)throw new Error("ChartManager not initialized. Call init() first.");let q=`chart-${++this.chartIdCounter}`,Q=document.createElement("div");Q.dataset.chartId=q,Q.style.cssText="width: 100%; height: 100%; position: relative;";let B=document.createElement("div");B.dataset.chartId=q,B.style.cssText="width: 100%; height: 100%; position: relative;";let J=document.createElement("canvas");J.style.cssText="position: absolute; inset: 0; width: 100%; height: 100%; pointer-events: none;";let K=document.createElement("canvas");K.style.cssText="position: absolute; inset: 0; width: 100%; height: 100%; pointer-events: auto; z-index: 1;";let j=document.createElement("canvas");j.style.cssText="position: absolute; inset: 0; width: 100%; height: 100%; pointer-events: none; z-index: 2;",B.appendChild(J),B.appendChild(K),B.appendChild(j),Q.appendChild(B),$.container.appendChild(Q);let L;try{L=K.transferControlToOffscreen()}catch(_){throw console.error(`ChartManager: Failed to create offscreen canvas for ${q}:`,_),new Error(`Failed to create chart ${q}: ${_}`)}let F=B.getBoundingClientRect(),G=F.width||400,R=F.height||200;if(A.resizeCanvas(L,G,R),A.resizeCanvas(J,G,R),A.resizeCanvas(j,G,R),$.bgColor){let[_,P,k]=$.bgColor;B.style.background=`rgb(${Math.round(_*255)},${Math.round(P*255)},${Math.round(k*255)})`}let V={id:q,config:$,el:Q,backCanvas:J,axisCanvas:j,width:G,height:R,series:[],bounds:{minX:0,maxX:1,minY:0,maxY:1},view:{panX:0,panY:0,zoomX:1,zoomY:1},zoomMode:$.zoomMode||"both",visible:!0,dragging:!1,bgColor:$.bgColor,textColor:$.textColor,gridColor:$.gridColor,fontFamily:$.fontFamily,momentum:null,findNearestPoint(_,P,k,D){if(this.series.length===0)return null;let I=_/k,i=P/D,p=this.bounds.maxX-this.bounds.minX,r=this.bounds.maxY-this.bounds.minY,f=p/this.view.zoomX,n=r/this.view.zoomY,l=this.bounds.minX+this.view.panX*p,o=this.bounds.minY+this.view.panY*r,v=l+I*f,m=o+(1-i)*n,C=-1,E=-1,T=1/0,S=1/0;for(let t=0;t<this.series.length;t++){let N=this.series[t],W=N.rawX.length;if(W===0)continue;let z=0,H=W-1;while(z<H){let u=z+H>>1;if(N.rawX[u]<v)z=u+1;else H=u}let X=z;if(z>0){let u=Math.abs(N.rawX[z]-v);if(Math.abs(N.rawX[z-1]-v)<u)X=z-1}let Y=Math.abs(N.rawX[X]-v),b=Math.abs(N.rawY[X]-m);if(Y<T||Y===T&&b<S)T=Y,S=b,C=t,E=X}if(C===-1)return null;let O=this.series[C],y=(O.rawX[E]-l)/f*k;if(Math.abs(y-_)>A.HOVER_MAX_DISTANCE_PX)return null;return{x:O.rawX[E],y:O.rawY[E],index:E,screenX:_,screenY:P,seriesIndex:C,seriesLabel:O.label}}};this.charts.set(q,V);let U=$.type==="bar"?"box":$.type;this.worker.postMessage({type:"register-chart",id:q,canvas:L,chartType:U,pointSize:$.pointSize??3,maxSamplesPerPixel:$.maxSamplesPerPixel??1e4,bgColor:$.bgColor??null},[L]),this.visibilityObserver.observe(Q),this.resizeObserver.observe(B);for(let _ of B0)_.install?.(V,B);return this.updateSeries(q,$.series),q}destroy($){let q=this.charts.get($);if(!q)return;for(let B of B0)B.uninstall?.(q);if(q.momentum)cancelAnimationFrame(q.momentum);this.visibilityObserver.unobserve(q.el);let Q=q.el.querySelector(".gpu-chart-canvas-wrap");if(Q)this.resizeObserver.unobserve(Q);q.el.remove(),this.worker?.postMessage({type:"unregister-chart",id:$}),this.charts.delete($)}updateSeries($,q){let Q=this.charts.get($);if(!Q||!this.worker)return;if(q.length===0)return;Q.series=q.map((V)=>{let U=V.x.length;if(U===0)return{label:V.label,color:V.color,rawX:[],rawY:[]};let _=Array.from({length:U},(P,k)=>k);return _.sort((P,k)=>V.x[P]-V.x[k]),{label:V.label,color:V.color,rawX:_.map((P)=>V.x[P]),rawY:_.map((P)=>V.y[P])}});let B=1/0,J=-1/0,K=1/0,j=-1/0;for(let V of Q.series)for(let U=0;U<V.rawX.length;U++){if(V.rawX[U]<B)B=V.rawX[U];if(V.rawX[U]>J)J=V.rawX[U];if(V.rawY[U]<K)K=V.rawY[U];if(V.rawY[U]>j)j=V.rawY[U]}let L=(J-B)*0.05||1,F=(j-K)*0.1||1;B-=L,J+=L,K-=F,j+=F;let G=Q.config.defaultBounds;if(G){if(G.minX!==void 0)B=G.minX;if(G.maxX!==void 0)J=G.maxX;if(G.minY!==void 0)K=G.minY;if(G.maxY!==void 0)j=G.maxY}Q.bounds={minX:B,maxX:J,minY:K,maxY:j};let R=Q.series.map((V)=>({label:V.label,colorR:V.color.r,colorG:V.color.g,colorB:V.color.b,dataX:new Float32Array(V.rawX),dataY:new Float32Array(V.rawY)}));this.worker.postMessage({type:"update-series",id:$,series:R,bounds:Q.bounds},R.flatMap((V)=>[V.dataX.buffer,V.dataY.buffer])),this.sendViewTransform(Q),this.drawChart(Q)}setPointSize($,q){if(!this.charts.get($))return;this.worker?.postMessage({type:"set-point-size",id:$,pointSize:Math.max(1,Math.min(8,Math.round(q)))})}setMaxSamplesPerPixel($,q){if(!this.charts.get($))return;this.worker?.postMessage({type:"set-max-samples",id:$,maxSamplesPerPixel:Math.max(0,q|0)})}setStyle($,q){let Q=this.charts.get($);if(!Q)return;if(q.bgColor!==void 0)Q.bgColor=q.bgColor;if(q.textColor!==void 0)Q.textColor=q.textColor;if(q.gridColor!==void 0)Q.gridColor=q.gridColor;if(q.fontFamily!==void 0)Q.fontFamily=q.fontFamily;if(q.bgColor!==void 0){let B=Q.el.querySelector(".gpu-chart-canvas-wrap");if(B){let[J,K,j]=q.bgColor;B.style.background=`rgb(${Math.round(J*255)},${Math.round(K*255)},${Math.round(j*255)})`}this.worker?.postMessage({type:"set-style",id:$,bgColor:q.bgColor})}this.drawChart(Q)}setZoomMode($,q){let Q=this.charts.get($);if(Q)Q.zoomMode=q}getChartCount(){return this.charts.size}getZoomMode($){return this.charts.get($)?.zoomMode||"both"}setSyncViews($){this._syncViews=$}setTheme($){this._isDark=$,this.worker?.postMessage({type:"theme",isDark:$});for(let q of this.charts.values())this.drawChart(q)}onStats($){return this.statsCallbacks.push($),()=>{let q=this.statsCallbacks.indexOf($);if(q>=0)this.statsCallbacks.splice(q,1)}}getStats(){return{...this.currentStats}}resetView($){let q=this.charts.get($);if(!q)return;if(q.momentum)cancelAnimationFrame(q.momentum),q.momentum=null;let Q=q.view.panX,B=q.view.panY,J=q.view.zoomX,K=q.view.zoomY,j=performance.now(),L=()=>{let F=Math.min(1,(performance.now()-j)/300),G=1-Math.pow(1-F,3);if(q.view.panX=Q*(1-G),q.view.panY=B*(1-G),q.view.zoomX=J+(1-J)*G,q.view.zoomY=K+(1-K)*G,this.sendViewTransform(q),this.drawChart(q),this._syncViews)this.syncAllViews(q);if(F<1)requestAnimationFrame(L)};requestAnimationFrame(L)}sendViewTransform($){this.worker?.postMessage({type:"view-transform",id:$.id,panX:$.view.panX,panY:$.view.panY,zoomX:$.view.zoomX,zoomY:$.view.zoomY})}syncAllViews($){let q=[];for(let Q of this.charts.values())if(Q.id!==$.id)Q.view={...$.view},q.push({id:Q.id}),this.drawChart(Q);if(q.length>0)this.worker?.postMessage({type:"batch-view-transform",panX:$.view.panX,panY:$.view.panY,zoomX:$.view.zoomX,zoomY:$.view.zoomY,transforms:q})}drawChart($){if(!$.visible)return;let q=devicePixelRatio||1,Q=$.backCanvas.getContext("2d");if(Q){Q.clearRect(0,0,$.backCanvas.width,$.backCanvas.height),Q.save(),Q.scale(q,q);for(let J of B0)J.beforeDraw?.(Q,$);Q.restore()}let B=$.axisCanvas.getContext("2d");if(B){B.clearRect(0,0,$.axisCanvas.width,$.axisCanvas.height),B.save(),B.scale(q,q);for(let J of B0)J.afterDraw?.(B,$);B.restore()}}}var F0=($,q,Q)=>{let B=q-$;if(B<=0)return[$];let J=B/Q,K=10**Math.floor(Math.log10(J)),j=J/K,L=K*(j<=1.5?1:j<=3?2:j<=7?5:10),F=[];for(let G=Math.ceil($/L)*L;G<=q;G+=L)F.push(G);return F},D0=($)=>{let q=A.getInstance(),Q=$.width,B=$.height,J=A.MARGIN,{bounds:K,view:j}=$,L=K.maxX-K.minX,F=K.maxY-K.minY,G=L/j.zoomX,R=F/j.zoomY,V=K.minX+j.panX*L,U=K.minY+j.panY*F,_=$.bgColor??(q.isDark?[0.11,0.11,0.12]:[0.98,0.98,0.98]);return{w:Q,h:B,m:J,rx:G,ry:R,mx:V,my:U,bg:`${Math.round(_[0]*255)},${Math.round(_[1]*255)},${Math.round(_[2]*255)}`,font:$.fontFamily??A.DEFAULT_FONT,text:$.textColor??(q.isDark?"#c0c0c0":"#333333"),grid:$.gridColor??(q.isDark?"rgba(255,255,255,0.06)":"rgba(0,0,0,0.06)")}},f0={name:"labels",beforeDraw($,q){let{w:Q,h:B,m:J,rx:K,ry:j,mx:L,my:F,grid:G}=D0(q);$.strokeStyle=G,$.lineWidth=1,$.beginPath(),F0(F,F+j,7).forEach((R)=>{let V=B*(1-(R-F)/j);if(V>5&&V<B-J.bottom-5)$.moveTo(J.left,V),$.lineTo(Q,V)}),F0(L,L+K,8).forEach((R)=>{let V=Q*((R-L)/K);if(V>J.left&&V<Q)$.moveTo(V,0),$.lineTo(V,B-J.bottom)}),$.stroke()},afterDraw($,q){let{w:Q,h:B,m:J,rx:K,ry:j,mx:L,my:F,bg:G,font:R,text:V}=D0(q),{formatX:U=String,formatY:_=String,labelSize:P=A.DEFAULT_LABEL_SIZE}=q.config,k=(D,I,i,p,r)=>{let f=D==="left"?$.createLinearGradient(I,0,I+p,0):$.createLinearGradient(0,i,0,i+r),n=D==="left"?[1,0.7,0.2,0.05,0]:[0,0.05,0.2,0.7,1];[0,0.35,0.55,0.7,1].forEach((l,o)=>f.addColorStop(l,`rgba(${G},${n[o]})`)),$.fillStyle=f,$.fillRect(I,i,p,r)};k("left",0,0,J.left+20,B),k("bottom",0,B-J.bottom-20,Q,J.bottom+20),$.font=`${P}px ${R}`,$.fillStyle=V,$.textAlign="right",$.textBaseline="middle",F0(F,F+j,7).forEach((D)=>{let I=B*(1-(D-F)/j);if(I>5&&I<B-J.bottom-5)$.fillText(_(D),J.left-5,I)}),$.textAlign="right",$.textBaseline="top",F0(L,L+K,8).forEach((D)=>{let I=Q*((D-L)/K);if(I<J.left-10||I>Q+30)return;$.save(),$.translate(I,B-J.bottom+5),$.rotate(-Math.PI/14),$.fillText(U(D),0,0),$.restore()})}};function T0($={}){let q=$.momentumDecay??0.9,Q=new WeakMap;return{name:"zoom",install(B,J){let K=J.style.touchAction,j=J.style.userSelect,L=J.style.webkitUserSelect;J.style.touchAction="none",J.style.userSelect="none",J.style.webkitUserSelect="none";let F=A.getInstance(),G=new AbortController,R={lastX:0,lastY:0,velX:0,velY:0,abort:G,originalTouchAction:K,originalUserSelect:j,originalWebkitUserSelect:L,el:J};Q.set(B,R);let V=[],U="none",_=0,P=0,k=0,D=0,I=0,i=10,p=10,r=500,f=null,n=0,l=1,o=1,v=0.5,m=0.5,C=0,E=0,T=0,S=null,O=0,e=1,y=()=>{if(F.sendViewTransform(B),F.drawChart(B),F.syncViews)F.syncAllViews(B)},a=()=>{if(B.momentum)cancelAnimationFrame(B.momentum);let N=()=>{if(C*=q,E*=q,Math.abs(C)>0.00005||Math.abs(E)>0.00005){if(B.zoomMode!=="none"&&(B.zoomMode==="both"||B.zoomMode==="x-only"))B.view.panX-=C/B.view.zoomX;if(B.zoomMode!=="none"&&(B.zoomMode==="both"||B.zoomMode==="y-only"))B.view.panY+=E/B.view.zoomY;y(),B.momentum=requestAnimationFrame(N)}else B.momentum=null};B.momentum=requestAnimationFrame(N)};J.addEventListener("pointerdown",(N)=>{if(B.momentum)cancelAnimationFrame(B.momentum),B.momentum=null;if(V.push(N),J.setPointerCapture(N.pointerId),V.length===1)if(U="detecting",_=N.clientX,P=N.clientY,k=N.clientX,D=N.clientY,C=E=0,I=performance.now(),S=null,N.pointerType==="touch")f=window.setTimeout(()=>{if(U==="detecting")U="press",B.dragging=!1},r);else{let W=J.getBoundingClientRect(),z=N.clientX-W.left,H=N.clientY-W.top,X=A.MARGIN,Y=z<X.left,b=H>W.height-X.bottom;if(Y&&!b)S="y",O=N.clientY,e=B.view.zoomY,B.dragging=!0;else if(b&&!Y)S="x",O=N.clientX,e=B.view.zoomX,B.dragging=!0;else B.dragging=!0}else if(V.length===2){if(f)clearTimeout(f),f=null;if(U="pinch",B.dragging=!1,N.pointerType==="touch")N.preventDefault();let W=J.getBoundingClientRect(),z=V[1].clientX-V[0].clientX,H=V[1].clientY-V[0].clientY;n=Math.hypot(z,H),l=B.view.zoomX,o=B.view.zoomY,v=((V[0].clientX+V[1].clientX)/2-W.left)/W.width,m=1-((V[0].clientY+V[1].clientY)/2-W.top)/W.height}},{passive:!1,signal:G.signal}),J.addEventListener("pointermove",(N)=>{let W=V.findIndex((z)=>z.pointerId===N.pointerId);if(W>=0)V[W]=N;if(V.length===1){let z=Math.hypot(N.clientX-_,N.clientY-P);if(U==="detecting"&&z>i){if(U="pan",B.dragging=!0,f)clearTimeout(f),f=null}if(U==="press")return;if(S&&N.pointerType!=="touch"){if(S==="x"){let H=N.clientX-O,X=Math.exp(H/200),Y=Math.max(A.MIN_ZOOM,Math.min(A.MAX_ZOOM,e*X)),b=B.view.panX+0.5/e;B.view.zoomX=Y,B.view.panX=b-0.5/Y,y();return}else if(S==="y"){let H=O-N.clientY,X=Math.exp(H/200),Y=Math.max(A.MIN_ZOOM,Math.min(A.MAX_ZOOM,e*X)),b=B.view.panY+0.5/e;B.view.zoomY=Y,B.view.panY=b-0.5/Y,y();return}}if(U==="pan"||B.dragging&&!S){let H=J.getBoundingClientRect(),X=(N.clientX-k)/H.width,Y=(N.clientY-D)/H.height,b=performance.now();if(b-I<100)C=C*0.3+X*0.7,E=E*0.3+Y*0.7;if(I=b,B.zoomMode!=="none"&&(B.zoomMode==="both"||B.zoomMode==="x-only"))B.view.panX-=X/B.view.zoomX;if(B.zoomMode!=="none"&&(B.zoomMode==="both"||B.zoomMode==="y-only"))B.view.panY+=Y/B.view.zoomY;k=N.clientX,D=N.clientY,y()}}else if(V.length===2&&U==="pinch"){if(N.pointerType==="touch")N.preventDefault();let z=V[1].clientX-V[0].clientX,H=V[1].clientY-V[0].clientY,Y=Math.hypot(z,H)-n,b=Math.exp(Y/300);if(B.zoomMode!=="none"&&(B.zoomMode==="both"||B.zoomMode==="x-only")){let u=Math.max(A.MIN_ZOOM,Math.min(A.MAX_ZOOM,l*b)),$0=B.view.panX+v/l;B.view.zoomX=u,B.view.panX=$0-v/u}if(B.zoomMode!=="none"&&(B.zoomMode==="both"||B.zoomMode==="y-only")){let u=Math.max(A.MIN_ZOOM,Math.min(A.MAX_ZOOM,o*b)),$0=B.view.panY+m/o;B.view.zoomY=u,B.view.panY=$0-m/u}y()}},{passive:!1,signal:G.signal});let t=(N)=>{if(V=V.filter((W)=>W.pointerId!==N.pointerId),J.releasePointerCapture(N.pointerId),f)clearTimeout(f),f=null;if(V.length===0){let z=Math.hypot(N.clientX-_,N.clientY-P)<p&&U!=="pan";if(z&&N.pointerType==="touch"){let H=Date.now();if(H-T<300)F.resetView(B.id),T=0;else T=H}if(z&&N.pointerType!=="touch"){let H=Date.now();if(H-T<300)F.resetView(B.id),T=0;else T=H}if(U==="pan"&&(Math.abs(C)>0.001||Math.abs(E)>0.001))a();U="none",B.dragging=!1,S=null}else if(V.length===1)U="detecting",_=V[0].clientX,P=V[0].clientY,k=V[0].clientX,D=V[0].clientY};J.addEventListener("pointerup",t,{signal:G.signal}),J.addEventListener("pointercancel",t,{signal:G.signal}),J.addEventListener("wheel",(N)=>{if(N.preventDefault(),B.momentum)cancelAnimationFrame(B.momentum),B.momentum=null;let W=J.getBoundingClientRect(),z=N.clientX-W.left,H=N.clientY-W.top,X=z/W.width,Y=1-H/W.height,b=1-N.deltaY*0.002,u=A.MARGIN,$0=z<u.left,g0=H>W.height-u.bottom,J0,Q0;if($0)J0=!1,Q0=!0;else if(g0)J0=!0,Q0=!1;else J0=B.zoomMode==="both"||B.zoomMode==="x-only",Q0=B.zoomMode==="both"||B.zoomMode==="y-only";if(J0){let _0=B.view.panX+X/B.view.zoomX;B.view.zoomX=Math.max(A.MIN_ZOOM,Math.min(A.MAX_ZOOM,B.view.zoomX*b)),B.view.panX=_0-X/B.view.zoomX}if(Q0){let _0=B.view.panY+Y/B.view.zoomY;B.view.zoomY=Math.max(A.MIN_ZOOM,Math.min(A.MAX_ZOOM,B.view.zoomY*b)),B.view.panY=_0-Y/B.view.zoomY}if(J0||Q0)y()},{passive:!1,signal:G.signal})},uninstall(B){let J=Q.get(B);if(J){if(B.momentum)cancelAnimationFrame(B.momentum),B.momentum=null;J.el.style.touchAction=J.originalTouchAction,J.el.style.userSelect=J.originalUserSelect,J.el.style.webkitUserSelect=J.originalWebkitUserSelect,J.abort.abort(),Q.delete(B)}}}}var U0=new WeakMap,n0=($,q,Q,B,J,K,j,L)=>{$.beginPath(),$.roundRect(q,Q,B,J,K),$.fillStyle=j,$.fill(),$.strokeStyle=L,$.lineWidth=1.5,$.stroke()},O0={name:"hover",install($,q){let Q=A.getInstance(),B=new AbortController,J={hoverResult:null,pillX:0,pillY:0,pillTargetX:0,pillTargetY:0,pillAnimRef:null,abort:B};U0.set($,J);let K=(L)=>{if($.config.onHover)$.config.onHover(L);if(!($.config.showTooltip??!1))return;if(J.hoverResult=L,Q.drawChart($),L&&!J.pillAnimRef){let F=performance.now(),G=(R)=>{if(!J.hoverResult)return J.pillAnimRef=null;let V=1-Math.pow(0.5,(R-F)/($.config.pillDecayMs??60));F=R,J.pillX+=(J.pillTargetX-J.pillX)*V,J.pillY+=(J.pillTargetY-J.pillY)*V,Q.drawChart($),J.pillAnimRef=requestAnimationFrame(G)};J.pillAnimRef=requestAnimationFrame(G)}},j=(L,F)=>{if($.dragging)return;let G=q.getBoundingClientRect();K($.findNearestPoint(L-G.left,F-G.top,G.width,G.height))};q.addEventListener("mousemove",(L)=>j(L.clientX,L.clientY),{signal:B.signal}),q.addEventListener("touchmove",(L)=>{if(L.touches.length===1)j(L.touches[0].clientX,L.touches[0].clientY)},{signal:B.signal,passive:!0}),["mouseleave","pointerdown","touchend","touchcancel"].forEach((L)=>q.addEventListener(L,()=>K(null),{signal:B.signal}))},afterDraw($,q){let Q=U0.get(q);if(!Q?.hoverResult||!q.config.showTooltip)return;let{hoverResult:B}=Q,J=q.width,K=q.height,j=A.MARGIN,L=A.getInstance().isDark,{formatX:F=String,formatY:G=String,fontFamily:R=A.DEFAULT_FONT}=q.config,V=(q.bounds.maxX-q.bounds.minX)/q.view.zoomX,U=(q.bounds.maxY-q.bounds.minY)/q.view.zoomY,_=(B.x-(q.bounds.minX+q.view.panX*(q.bounds.maxX-q.bounds.minX)))/V*J,P=K*(1-(B.y-(q.bounds.minY+q.view.panY*(q.bounds.maxY-q.bounds.minY)))/U),k=q.series[B.seriesIndex]||q.series[0],D=`${Math.round(k.color.r*255)},${Math.round(k.color.g*255)},${Math.round(k.color.b*255)}`,I=`rgb(${D})`,i=L?`oklch(from ${I} calc(l + 0.1) c h)`:I;$.save(),$.setLineDash([4,3]),$.strokeStyle=`rgba(${D},0.4)`,$.stroke(new Path2D(`M${_} 0V${K-j.bottom}M${j.left} ${P}H${J}`)),$.restore(),$.beginPath(),$.arc(_,P,4.5,0,Math.PI*2),$.fillStyle=I,$.fill(),$.strokeStyle=L?"rgba(0,0,0,0.6)":"rgba(255,255,255,0.9)",$.stroke();let p=q.series.map((E)=>{let T=0,S=E.rawX.length-1;while(T<=S){let O=T+S>>1;if(Math.abs(E.rawX[O]-B.x)<0.0001)return{label:E.label,val:G(E.rawY[O]),rawVal:E.rawY[O],col:`rgb(${Math.round(E.color.r*255)},${Math.round(E.color.g*255)},${Math.round(E.color.b*255)})`};E.rawX[O]<B.x?T=O+1:S=O-1}return null}).filter(Boolean);p.sort((E,T)=>Math.abs(T.rawVal)-Math.abs(E.rawVal));let r=p.length,f=p.slice(0,5),n=r-f.length;if(Q.pillTargetX=_,Q.pillTargetY=P,!Q.pillAnimRef)Q.pillX=_,Q.pillY=P;let l=(E,T,S,O)=>{$.font=`600 10px ${R}`;let e=$.measureText(S).width,y=e+12,a=18,t=O?E-y/2:E-y,N=O?T:T-a/2;$.save();let W=O?Math.atan((Q.pillTargetX-Q.pillX)/80)*0.2:Math.atan((Q.pillTargetY-Q.pillY)/80)*0.2;$.translate(E,T),$.rotate(W);let z=O?-y/2:-y,H=O?0:-a/2;$.beginPath(),$.roundRect(z,H,y,a,4),$.fillStyle=L?"rgba(0,0,0,0.75)":"rgba(255,255,255,0.75)",$.fill(),$.fillStyle=`rgba(${D},0.2)`,$.fill(),$.strokeStyle=i,$.lineWidth=1.5,$.stroke(),$.fillStyle=i,$.textAlign="center",$.textBaseline="middle",$.fillText(S,z+y/2,H+a/2),$.restore()};l(Math.max(j.left,Math.min(J-j.right,Q.pillX)),K-j.bottom+4,F(B.x),!0),l(Math.max(j.left,j.left),Math.max(9,Math.min(K-j.bottom-9,Q.pillY)),G(B.y),!1);let o=Math.max(...f.map((E)=>$.measureText(E.label+E.val).width))+40,v=30+f.length*18+(n>0?18:0),m=B.screenX+14,C=B.screenY-v-6;if(m+o>J)m=B.screenX-o-14;if(C=Math.max(4,Math.min(K-v-4,B.screenY-v-6)),n0($,m,C,o,v,6,L?"rgba(28,28,30,0.95)":"rgba(255,255,255,0.96)","rgba(0,0,0,0.08)"),$.textAlign="left",$.textBaseline="middle",$.fillStyle=L?"#888":"#999",$.fillText(F(B.x),m+10,C+15),f.forEach((E,T)=>{let S=C+35+T*18;$.fillStyle=E.col,$.beginPath(),$.roundRect(m+10,S-4,8,8,2),$.fill(),$.fillStyle=L?"#eee":"#1a1a1a",$.fillText(`${E.label}: ${E.val}`,m+24,S)}),n>0){let E=C+35+f.length*18;$.fillStyle=L?"#666":"#aaa",$.fillText(`+${n} more`,m+10,E)}},uninstall($){let q=U0.get($);if(q?.pillAnimRef)cancelAnimationFrame(q.pillAnimRef);q?.abort.abort(),U0.delete($)}};L0(f0);L0(T0());L0(O0);var K0=16,S0=320,Y0=240,k0=480,H0=320,h0=0.1,s0=4,c0=0.0015,E0=[{name:"US GDP (1960–2024)",category:"GDP & Growth",url:"https://api.worldbank.org/v2/country/us/indicator/NY.GDP.MKTP.CD?date=1960:2024&format=json&per_page=100",transform:`const items = data[1].filter(d => d.value != null).reverse();
return { x: items.map(d => parseInt(d.date)), y: items.map(d => d.value) };`,type:"line"},{name:"China GDP (1960–2024)",category:"GDP & Growth",url:"https://api.worldbank.org/v2/country/cn/indicator/NY.GDP.MKTP.CD?date=1960:2024&format=json&per_page=100",transform:`const items = data[1].filter(d => d.value != null).reverse();
return { x: items.map(d => parseInt(d.date)), y: items.map(d => d.value) };`,type:"line"},{name:"India GDP (1960–2024)",category:"GDP & Growth",url:"https://api.worldbank.org/v2/country/in/indicator/NY.GDP.MKTP.CD?date=1960:2024&format=json&per_page=100",transform:`const items = data[1].filter(d => d.value != null).reverse();
return { x: items.map(d => parseInt(d.date)), y: items.map(d => d.value) };`,type:"line"},{name:"Japan GDP (1960–2024)",category:"GDP & Growth",url:"https://api.worldbank.org/v2/country/jp/indicator/NY.GDP.MKTP.CD?date=1960:2024&format=json&per_page=100",transform:`const items = data[1].filter(d => d.value != null).reverse();
return { x: items.map(d => parseInt(d.date)), y: items.map(d => d.value) };`,type:"line"},{name:"Germany GDP (1960–2024)",category:"GDP & Growth",url:"https://api.worldbank.org/v2/country/de/indicator/NY.GDP.MKTP.CD?date=1960:2024&format=json&per_page=100",transform:`const items = data[1].filter(d => d.value != null).reverse();
return { x: items.map(d => parseInt(d.date)), y: items.map(d => d.value) };`,type:"line"},{name:"Brazil GDP (1960–2024)",category:"GDP & Growth",url:"https://api.worldbank.org/v2/country/br/indicator/NY.GDP.MKTP.CD?date=1960:2024&format=json&per_page=100",transform:`const items = data[1].filter(d => d.value != null).reverse();
return { x: items.map(d => parseInt(d.date)), y: items.map(d => d.value) };`,type:"line"},{name:"Nigeria GDP (1960–2024)",category:"GDP & Growth",url:"https://api.worldbank.org/v2/country/ng/indicator/NY.GDP.MKTP.CD?date=1960:2024&format=json&per_page=100",transform:`const items = data[1].filter(d => d.value != null).reverse();
return { x: items.map(d => parseInt(d.date)), y: items.map(d => d.value) };`,type:"line"},{name:"US GDP per Capita",category:"GDP & Growth",url:"https://api.worldbank.org/v2/country/us/indicator/NY.GDP.PCAP.CD?date=1960:2024&format=json&per_page=100",transform:`const items = data[1].filter(d => d.value != null).reverse();
return { x: items.map(d => parseInt(d.date)), y: items.map(d => d.value) };`,type:"line"},{name:"China GDP Growth % (annual)",category:"GDP & Growth",url:"https://api.worldbank.org/v2/country/cn/indicator/NY.GDP.MKTP.KD.ZG?date=1960:2024&format=json&per_page=100",transform:`const items = data[1].filter(d => d.value != null).reverse();
return { x: items.map(d => parseInt(d.date)), y: items.map(d => d.value) };`,type:"bar"},{name:"India GDP Growth % (annual)",category:"GDP & Growth",url:"https://api.worldbank.org/v2/country/in/indicator/NY.GDP.MKTP.KD.ZG?date=1960:2024&format=json&per_page=100",transform:`const items = data[1].filter(d => d.value != null).reverse();
return { x: items.map(d => parseInt(d.date)), y: items.map(d => d.value) };`,type:"bar"},{name:"Bitcoin 1yr",category:"Crypto",url:"https://api.coingecko.com/api/v3/coins/bitcoin/market_chart?vs_currency=usd&days=365",transform:`const p = data.prices;
return { x: p.map((_, i) => i), y: p.map(d => d[1]) };`,type:"line"},{name:"Ethereum 1yr",category:"Crypto",url:"https://api.coingecko.com/api/v3/coins/ethereum/market_chart?vs_currency=usd&days=365",transform:`const p = data.prices;
return { x: p.map((_, i) => i), y: p.map(d => d[1]) };`,type:"line"},{name:"Solana 90d",category:"Crypto",url:"https://api.coingecko.com/api/v3/coins/solana/market_chart?vs_currency=usd&days=90",transform:`const p = data.prices;
return { x: p.map((_, i) => i), y: p.map(d => d[1]) };`,type:"line"},{name:"Dogecoin 90d",category:"Crypto",url:"https://api.coingecko.com/api/v3/coins/dogecoin/market_chart?vs_currency=usd&days=90",transform:`const p = data.prices;
return { x: p.map((_, i) => i), y: p.map(d => d[1]) };`,type:"line"},{name:"Cardano 90d",category:"Crypto",url:"https://api.coingecko.com/api/v3/coins/cardano/market_chart?vs_currency=usd&days=90",transform:`const p = data.prices;
return { x: p.map((_, i) => i), y: p.map(d => d[1]) };`,type:"line"},{name:"XRP 90d",category:"Crypto",url:"https://api.coingecko.com/api/v3/coins/ripple/market_chart?vs_currency=usd&days=90",transform:`const p = data.prices;
return { x: p.map((_, i) => i), y: p.map(d => d[1]) };`,type:"line"},{name:"Polkadot 90d",category:"Crypto",url:"https://api.coingecko.com/api/v3/coins/polkadot/market_chart?vs_currency=usd&days=90",transform:`const p = data.prices;
return { x: p.map((_, i) => i), y: p.map(d => d[1]) };`,type:"line"},{name:"Chainlink 90d",category:"Crypto",url:"https://api.coingecko.com/api/v3/coins/chainlink/market_chart?vs_currency=usd&days=90",transform:`const p = data.prices;
return { x: p.map((_, i) => i), y: p.map(d => d[1]) };`,type:"line"},{name:"BTC Volume 30d",category:"Crypto",url:"https://api.coingecko.com/api/v3/coins/bitcoin/market_chart?vs_currency=usd&days=30",transform:`const v = data.total_volumes;
return { x: v.map((_, i) => i), y: v.map(d => d[1]) };`,type:"bar"},{name:"ETH Volume 30d",category:"Crypto",url:"https://api.coingecko.com/api/v3/coins/ethereum/market_chart?vs_currency=usd&days=30",transform:`const v = data.total_volumes;
return { x: v.map((_, i) => i), y: v.map(d => d[1]) };`,type:"bar"},{name:"BTC Market Cap 1yr",category:"Crypto",url:"https://api.coingecko.com/api/v3/coins/bitcoin/market_chart?vs_currency=usd&days=365",transform:`const m = data.market_caps;
return { x: m.map((_, i) => i), y: m.map(d => d[1]) };`,type:"line"},{name:"World Population",category:"Population & Society",url:"https://api.worldbank.org/v2/country/wld/indicator/SP.POP.TOTL?date=1960:2024&format=json&per_page=100",transform:`const items = data[1].filter(d => d.value != null).reverse();
return { x: items.map(d => parseInt(d.date)), y: items.map(d => d.value) };`,type:"line"},{name:"India Population",category:"Population & Society",url:"https://api.worldbank.org/v2/country/in/indicator/SP.POP.TOTL?date=1960:2024&format=json&per_page=100",transform:`const items = data[1].filter(d => d.value != null).reverse();
return { x: items.map(d => parseInt(d.date)), y: items.map(d => d.value) };`,type:"line"},{name:"Japan Population (decline)",category:"Population & Society",url:"https://api.worldbank.org/v2/country/jp/indicator/SP.POP.TOTL?date=1960:2024&format=json&per_page=100",transform:`const items = data[1].filter(d => d.value != null).reverse();
return { x: items.map(d => parseInt(d.date)), y: items.map(d => d.value) };`,type:"line"},{name:"Nigeria Population (boom)",category:"Population & Society",url:"https://api.worldbank.org/v2/country/ng/indicator/SP.POP.TOTL?date=1960:2024&format=json&per_page=100",transform:`const items = data[1].filter(d => d.value != null).reverse();
return { x: items.map(d => parseInt(d.date)), y: items.map(d => d.value) };`,type:"line"},{name:"US Life Expectancy",category:"Population & Society",url:"https://api.worldbank.org/v2/country/us/indicator/SP.DYN.LE00.IN?date=1960:2024&format=json&per_page=100",transform:`const items = data[1].filter(d => d.value != null).reverse();
return { x: items.map(d => parseInt(d.date)), y: items.map(d => d.value) };`,type:"line"},{name:"Japan Life Expectancy",category:"Population & Society",url:"https://api.worldbank.org/v2/country/jp/indicator/SP.DYN.LE00.IN?date=1960:2024&format=json&per_page=100",transform:`const items = data[1].filter(d => d.value != null).reverse();
return { x: items.map(d => parseInt(d.date)), y: items.map(d => d.value) };`,type:"line"},{name:"Global Fertility Rate",category:"Population & Society",url:"https://api.worldbank.org/v2/country/wld/indicator/SP.DYN.TFRT.IN?date=1960:2024&format=json&per_page=100",transform:`const items = data[1].filter(d => d.value != null).reverse();
return { x: items.map(d => parseInt(d.date)), y: items.map(d => d.value) };`,type:"line"},{name:"Global Infant Mortality",category:"Population & Society",url:"https://api.worldbank.org/v2/country/wld/indicator/SP.DYN.IMRT.IN?date=1960:2024&format=json&per_page=100",transform:`const items = data[1].filter(d => d.value != null).reverse();
return { x: items.map(d => parseInt(d.date)), y: items.map(d => d.value) };`,type:"line"},{name:"US Unemployment %",category:"Population & Society",url:"https://api.worldbank.org/v2/country/us/indicator/SL.UEM.TOTL.NE.ZS?date=1991:2024&format=json&per_page=100",transform:`const items = data[1].filter(d => d.value != null).reverse();
return { x: items.map(d => parseInt(d.date)), y: items.map(d => d.value) };`,type:"line"},{name:"South Africa Unemployment %",category:"Population & Society",url:"https://api.worldbank.org/v2/country/za/indicator/SL.UEM.TOTL.NE.ZS?date=1991:2024&format=json&per_page=100",transform:`const items = data[1].filter(d => d.value != null).reverse();
return { x: items.map(d => parseInt(d.date)), y: items.map(d => d.value) };`,type:"line"},{name:"Global CO2 (kt)",category:"Energy & Emissions",url:"https://api.worldbank.org/v2/country/wld/indicator/EN.ATM.CO2E.KT?date=1960:2022&format=json&per_page=100",transform:`const items = data[1].filter(d => d.value != null).reverse();
return { x: items.map(d => parseInt(d.date)), y: items.map(d => d.value) };`,type:"line"},{name:"US CO2 per Capita",category:"Energy & Emissions",url:"https://api.worldbank.org/v2/country/us/indicator/EN.ATM.CO2E.PC?date=1960:2022&format=json&per_page=100",transform:`const items = data[1].filter(d => d.value != null).reverse();
return { x: items.map(d => parseInt(d.date)), y: items.map(d => d.value) };`,type:"line"},{name:"China CO2 per Capita",category:"Energy & Emissions",url:"https://api.worldbank.org/v2/country/cn/indicator/EN.ATM.CO2E.PC?date=1960:2022&format=json&per_page=100",transform:`const items = data[1].filter(d => d.value != null).reverse();
return { x: items.map(d => parseInt(d.date)), y: items.map(d => d.value) };`,type:"line"},{name:"Global Renewable Energy %",category:"Energy & Emissions",url:"https://api.worldbank.org/v2/country/wld/indicator/EG.FEC.RNEW.ZS?date=1990:2022&format=json&per_page=100",transform:`const items = data[1].filter(d => d.value != null).reverse();
return { x: items.map(d => parseInt(d.date)), y: items.map(d => d.value) };`,type:"line"},{name:"Global Electricity Access %",category:"Energy & Emissions",url:"https://api.worldbank.org/v2/country/wld/indicator/EG.ELC.ACCS.ZS?date=1990:2024&format=json&per_page=100",transform:`const items = data[1].filter(d => d.value != null).reverse();
return { x: items.map(d => parseInt(d.date)), y: items.map(d => d.value) };`,type:"line"},{name:"India Electricity Access %",category:"Energy & Emissions",url:"https://api.worldbank.org/v2/country/in/indicator/EG.ELC.ACCS.ZS?date=1990:2024&format=json&per_page=100",transform:`const items = data[1].filter(d => d.value != null).reverse();
return { x: items.map(d => parseInt(d.date)), y: items.map(d => d.value) };`,type:"line"},{name:"Brazil Forest Area %",category:"Energy & Emissions",url:"https://api.worldbank.org/v2/country/br/indicator/AG.LND.FRST.ZS?date=1990:2022&format=json&per_page=100",transform:`const items = data[1].filter(d => d.value != null).reverse();
return { x: items.map(d => parseInt(d.date)), y: items.map(d => d.value) };`,type:"line"},{name:"Global Internet Users %",category:"Technology & Trade",url:"https://api.worldbank.org/v2/country/wld/indicator/IT.NET.USER.ZS?date=1990:2024&format=json&per_page=100",transform:`const items = data[1].filter(d => d.value != null).reverse();
return { x: items.map(d => parseInt(d.date)), y: items.map(d => d.value) };`,type:"line"},{name:"China Mobile Subscriptions / 100",category:"Technology & Trade",url:"https://api.worldbank.org/v2/country/cn/indicator/IT.CEL.SETS.P2?date=1960:2024&format=json&per_page=100",transform:`const items = data[1].filter(d => d.value != null).reverse();
return { x: items.map(d => parseInt(d.date)), y: items.map(d => d.value) };`,type:"line"},{name:"India Internet Users %",category:"Technology & Trade",url:"https://api.worldbank.org/v2/country/in/indicator/IT.NET.USER.ZS?date=1990:2024&format=json&per_page=100",transform:`const items = data[1].filter(d => d.value != null).reverse();
return { x: items.map(d => parseInt(d.date)), y: items.map(d => d.value) };`,type:"line"},{name:"US R&D Spending % GDP",category:"Technology & Trade",url:"https://api.worldbank.org/v2/country/us/indicator/GB.XPD.RSDV.GD.ZS?date=1996:2024&format=json&per_page=100",transform:`const items = data[1].filter(d => d.value != null).reverse();
return { x: items.map(d => parseInt(d.date)), y: items.map(d => d.value) };`,type:"line"},{name:"South Korea R&D % GDP",category:"Technology & Trade",url:"https://api.worldbank.org/v2/country/kr/indicator/GB.XPD.RSDV.GD.ZS?date=1996:2024&format=json&per_page=100",transform:`const items = data[1].filter(d => d.value != null).reverse();
return { x: items.map(d => parseInt(d.date)), y: items.map(d => d.value) };`,type:"line"},{name:"US Military Spending % GDP",category:"Technology & Trade",url:"https://api.worldbank.org/v2/country/us/indicator/MS.MIL.XPND.GD.ZS?date=1960:2024&format=json&per_page=100",transform:`const items = data[1].filter(d => d.value != null).reverse();
return { x: items.map(d => parseInt(d.date)), y: items.map(d => d.value) };`,type:"line"},{name:"Global Trade % of GDP",category:"Technology & Trade",url:"https://api.worldbank.org/v2/country/wld/indicator/NE.TRD.GNFS.ZS?date=1960:2024&format=json&per_page=100",transform:`const items = data[1].filter(d => d.value != null).reverse();
return { x: items.map(d => parseInt(d.date)), y: items.map(d => d.value) };`,type:"line"},{name:"US Inflation (CPI %)",category:"Technology & Trade",url:"https://api.worldbank.org/v2/country/us/indicator/FP.CPI.TOTL.ZG?date=1960:2024&format=json&per_page=100",transform:`const items = data[1].filter(d => d.value != null).reverse();
return { x: items.map(d => parseInt(d.date)), y: items.map(d => d.value) };`,type:"line"},{name:"Argentina Inflation (CPI %)",category:"Technology & Trade",url:"https://api.worldbank.org/v2/country/ar/indicator/FP.CPI.TOTL.ZG?date=1960:2024&format=json&per_page=100",transform:`const items = data[1].filter(d => d.value != null).reverse();
return { x: items.map(d => parseInt(d.date)), y: items.map(d => d.value) };`,type:"bar"},{name:"SF Bay Temp (10yr daily)",category:"Climate & Weather",url:"https://power.larc.nasa.gov/api/temporal/daily/point?parameters=T2M&community=SB&longitude=-122.4&latitude=37.8&start=20150101&end=20241231&format=JSON",transform:`const temps = data.properties.parameter.T2M;
const entries = Object.entries(temps).filter(([k, v]) => v !== -999);
return { x: entries.map((_, i) => i), y: entries.map(([k, v]) => v) };`,type:"line"},{name:"Tokyo Temp (10yr daily)",category:"Climate & Weather",url:"https://power.larc.nasa.gov/api/temporal/daily/point?parameters=T2M&community=SB&longitude=139.7&latitude=35.7&start=20150101&end=20241231&format=JSON",transform:`const temps = data.properties.parameter.T2M;
const entries = Object.entries(temps).filter(([k, v]) => v !== -999);
return { x: entries.map((_, i) => i), y: entries.map(([k, v]) => v) };`,type:"line"},{name:"Death Valley Temp (10yr)",category:"Climate & Weather",url:"https://power.larc.nasa.gov/api/temporal/daily/point?parameters=T2M&community=SB&longitude=-116.8&latitude=36.5&start=20150101&end=20241231&format=JSON",transform:`const temps = data.properties.parameter.T2M;
const entries = Object.entries(temps).filter(([k, v]) => v !== -999);
return { x: entries.map((_, i) => i), y: entries.map(([k, v]) => v) };`,type:"line"},{name:"Antarctica Temp (10yr)",category:"Climate & Weather",url:"https://power.larc.nasa.gov/api/temporal/daily/point?parameters=T2M&community=SB&longitude=0&latitude=-85&start=20150101&end=20241231&format=JSON",transform:`const temps = data.properties.parameter.T2M;
const entries = Object.entries(temps).filter(([k, v]) => v !== -999);
return { x: entries.map((_, i) => i), y: entries.map(([k, v]) => v) };`,type:"line"},{name:"Sahara Solar Radiation (10yr)",category:"Climate & Weather",url:"https://power.larc.nasa.gov/api/temporal/daily/point?parameters=ALLSKY_SFC_SW_DWN&community=SB&longitude=3&latitude=23.5&start=20150101&end=20241231&format=JSON",transform:`const param = data.properties.parameter.ALLSKY_SFC_SW_DWN;
const entries = Object.entries(param).filter(([k, v]) => v !== -999);
return { x: entries.map((_, i) => i), y: entries.map(([k, v]) => v) };`,type:"line"},{name:"London Solar Radiation (10yr)",category:"Climate & Weather",url:"https://power.larc.nasa.gov/api/temporal/daily/point?parameters=ALLSKY_SFC_SW_DWN&community=SB&longitude=-0.12&latitude=51.5&start=20150101&end=20241231&format=JSON",transform:`const param = data.properties.parameter.ALLSKY_SFC_SW_DWN;
const entries = Object.entries(param).filter(([k, v]) => v !== -999);
return { x: entries.map((_, i) => i), y: entries.map(([k, v]) => v) };`,type:"line"},{name:"Reykjavik Wind Speed (10yr)",category:"Climate & Weather",url:"https://power.larc.nasa.gov/api/temporal/daily/point?parameters=WS10M&community=SB&longitude=-21.9&latitude=64.1&start=20150101&end=20241231&format=JSON",transform:`const param = data.properties.parameter.WS10M;
const entries = Object.entries(param).filter(([k, v]) => v !== -999);
return { x: entries.map((_, i) => i), y: entries.map(([k, v]) => v) };`,type:"line"},{name:"Mumbai Humidity (10yr)",category:"Climate & Weather",url:"https://power.larc.nasa.gov/api/temporal/daily/point?parameters=RH2M&community=SB&longitude=72.9&latitude=19.1&start=20150101&end=20241231&format=JSON",transform:`const param = data.properties.parameter.RH2M;
const entries = Object.entries(param).filter(([k, v]) => v !== -999);
return { x: entries.map((_, i) => i), y: entries.map(([k, v]) => v) };`,type:"line"},{name:"Denver Precipitation (10yr)",category:"Climate & Weather",url:"https://power.larc.nasa.gov/api/temporal/daily/point?parameters=PRECTOTCORR&community=SB&longitude=-104.9&latitude=39.7&start=20150101&end=20241231&format=JSON",transform:`const param = data.properties.parameter.PRECTOTCORR;
const entries = Object.entries(param).filter(([k, v]) => v !== -999);
return { x: entries.map((_, i) => i), y: entries.map(([k, v]) => v) };`,type:"bar"},{name:"Earthquakes (30d scatter)",category:"Seismology",url:"https://earthquake.usgs.gov/earthquakes/feed/v1.0/summary/all_month.geojson",transform:`const f = data.features.filter(f => f.properties.mag != null);
f.sort((a, b) => a.properties.time - b.properties.time);
const t0 = f[0]?.properties.time || 0;
return {
  x: f.map(f => (f.properties.time - t0) / 3600000),
  y: f.map(f => f.properties.mag)
};`,type:"scatter"},{name:"Earthquake Depth vs Mag",category:"Seismology",url:"https://earthquake.usgs.gov/earthquakes/feed/v1.0/summary/all_month.geojson",transform:`const f = data.features.filter(f => f.properties.mag != null && f.geometry.coordinates[2] > 0);
return {
  x: f.map(f => f.geometry.coordinates[2]),
  y: f.map(f => f.properties.mag)
};`,type:"scatter"},{name:"Quake Lat vs Lng (plate map)",category:"Seismology",url:"https://earthquake.usgs.gov/earthquakes/feed/v1.0/summary/all_month.geojson",transform:`const f = data.features.filter(f => f.properties.mag != null);
return {
  x: f.map(f => f.geometry.coordinates[0]),
  y: f.map(f => f.geometry.coordinates[1])
};`,type:"scatter"},{name:"Significant Quakes (30d)",category:"Seismology",url:"https://earthquake.usgs.gov/earthquakes/feed/v1.0/summary/significant_month.geojson",transform:`const f = data.features.filter(f => f.properties.mag != null);
f.sort((a, b) => a.properties.time - b.properties.time);
return {
  x: f.map((_, i) => i),
  y: f.map(f => f.properties.mag)
};`,type:"bar"},{name:"M4.5+ Quakes (30d)",category:"Seismology",url:"https://earthquake.usgs.gov/earthquakes/feed/v1.0/summary/4.5_month.geojson",transform:`const f = data.features.filter(f => f.properties.mag != null);
f.sort((a, b) => a.properties.time - b.properties.time);
const t0 = f[0]?.properties.time || 0;
return {
  x: f.map(f => (f.properties.time - t0) / 3600000),
  y: f.map(f => f.properties.mag)
};`,type:"scatter"},{name:"Random Walk (100k)",category:"Synthetic",url:"",transform:`const n = 100000;
const x = new Array(n), y = new Array(n);
let v = 0;
for (let i = 0; i < n; i++) { x[i] = i; v += (Math.random() - 0.498) * 2; y[i] = v; }
return { x, y };`,type:"line"},{name:"Random Walk (1M)",category:"Synthetic",url:"",transform:`const n = 1000000;
const x = new Array(n), y = new Array(n);
let v = 0;
for (let i = 0; i < n; i++) { x[i] = i; v += (Math.random() - 0.498) * 2; y[i] = v; }
return { x, y };`,type:"line"},{name:"Sine Waves (10k)",category:"Synthetic",url:"",transform:`const n = 10000;
const x = new Array(n), y = new Array(n);
for (let i = 0; i < n; i++) { x[i] = i; y[i] = Math.sin(i * 0.01) + Math.sin(i * 0.03) * 0.5; }
return { x, y };`,type:"line"},{name:"Noise Cloud (50k)",category:"Synthetic",url:"",transform:`const n = 50000;
const x = new Array(n), y = new Array(n);
for (let i = 0; i < n; i++) {
  const a = Math.random() * Math.PI * 2;
  const r = Math.sqrt(-2 * Math.log(Math.random()));
  x[i] = Math.cos(a) * r; y[i] = Math.sin(a) * r;
}
return { x, y };`,type:"scatter"},{name:"Deadmau5 (10M)",category:"Synthetic",url:"",transform:`const N = 10000000, x = new Array(N), y = new Array(N);
const rp = (cx, cy, r) => {
  const a = Math.random() * 6.2832, d = Math.sqrt(Math.random()) * r;
  return [cx + Math.cos(a) * d, cy + Math.sin(a) * d];
};
let i = 0;
while (i < N) {
  let p, s = Math.random();
  if (s < 0.5) {
    p = rp(0, 0, 5);
    const lx = p[0] + 1.7, ly = p[1] - 0.8, rx = p[0] - 1.7, ry = p[1] - 0.8;
    if (lx * lx + ly * ly < 1.44 || rx * rx + ry * ry < 1.44) continue;
    const sd = p[0] * p[0] + (p[1] + 1) * (p[1] + 1);
    if (p[1] < -1 && sd > 5.76 && sd < 9 && Math.abs(p[0]) < 2.8) continue;
  } else if (s < 0.75) { p = rp(-3.8, 5.8, 3); }
  else { p = rp(3.8, 5.8, 3); }
  x[i] = p[0]; y[i] = p[1]; i++;
}
return { x, y };`,type:"scatter"},{name:"Spiral Galaxy (5M)",category:"Synthetic",url:"",transform:`const N = 5000000, x = new Array(N), y = new Array(N);
for (let i = 0; i < N; i++) {
  const arm = (Math.random() * 4) | 0;
  const d = Math.sqrt(Math.random()) * 12;
  const a = d * 0.7 + arm * 1.5708 + (Math.random() - 0.5) * (0.4 + d * 0.04);
  x[i] = Math.cos(a) * d;
  y[i] = Math.sin(a) * d;
}
return { x, y };`,type:"scatter"},{name:"Heart (2M)",category:"Synthetic",url:"",transform:`const N = 2000000, x = new Array(N), y = new Array(N);
let i = 0;
while (i < N) {
  const px = (Math.random() - 0.5) * 36, py = (Math.random() - 0.5) * 34;
  const nx = px / 16, ny = (py - 3) / 16;
  const v = nx * nx + ny * ny - 1;
  if (v * v * v - nx * nx * ny * ny * ny <= 0) { x[i] = px; y[i] = py; i++; }
}
return { x, y };`,type:"scatter"},{name:"Lissajous (500k)",category:"Synthetic",url:"",transform:`const N = 500000, x = new Array(N), y = new Array(N);
for (let i = 0; i < N; i++) {
  const t = i * 0.0001 + Math.random() * 0.02;
  x[i] = Math.sin(3 * t + 0.5) + (Math.random() - 0.5) * 0.05;
  y[i] = Math.sin(5 * t) + (Math.random() - 0.5) * 0.05;
}
return { x, y };`,type:"scatter"}],x,h=[],M0=1,s=0,c=0,w=1,g,V0,q0,Z=null,R0=null,G0=null,C0=0,X0=0;function M($){return Math.round($/K0)*K0}function r0($,q){return $.x<q.x+q.w&&$.x+$.w>q.x&&$.y<q.y+q.h&&$.y+$.h>q.y}function d($,q){for(let Q of h){if(Q.id===q)continue;if(r0($,Q))return!0}return!1}function e0($,q){let Q=g.getBoundingClientRect();return{x:($-Q.left-s)/w,y:(q-Q.top-c)/w}}function t0($,q,Q){let B=(1-Math.abs(2*Q-1))*q,J=B*(1-Math.abs($/60%2-1)),K=Q-B/2,j=0,L=0,F=0;if($<60)j=B,L=J;else if($<120)j=J,L=B;else if($<180)L=B,F=J;else if($<240)L=J,F=B;else if($<300)j=J,F=B;else j=B,F=J;return{r:j+K,g:L+K,b:F+K}}function P0(){return t0(Math.random()*360,0.6+Math.random()*0.2,0.5+Math.random()*0.15)}function a0(){let q=new Array(1000),Q=new Array(1000),B=50;for(let J=0;J<1000;J++)q[J]=J,B+=(Math.random()-0.498)*3,Q[J]=B;return{x:q,y:Q}}function $5($){if(Math.abs($)>=1e6)return($/1e6).toFixed(1)+"M";if(Math.abs($)>=1000)return($/1000).toFixed(1)+"k";if(Math.abs($)>=100)return $.toFixed(0);if(Math.abs($)>=10)return $.toFixed(1);return $.toFixed(2)}function B5($){return Math.round($).toString()}function q5($){if($>=1e6)return($/1e6).toFixed(1)+"M";if($>=1000)return($/1000).toFixed(0)+"k";return $.toString()}var b0=document.createElement("canvas").getContext("2d");function J5($,q){return b0.font=q,b0.measureText($||" ").width}function Z0(){V0.style.transform=`translate(${s}px, ${c}px) scale(${w})`;let $=24*w;g.style.backgroundSize=`${$}px ${$}px`,g.style.backgroundPosition=`${s%$}px ${c%$}px`}var y0=0;function Q5(){let $=document.getElementById("zoom-indicator");$.textContent=Math.round(w*100)+"%",$.classList.add("visible"),clearTimeout(y0),y0=window.setTimeout(()=>$.classList.remove("visible"),800)}function j5(){g=document.getElementById("viewport"),V0=document.getElementById("canvas"),q0=document.getElementById("context-menu"),g.addEventListener("wheel",($)=>{$.preventDefault();let q=-$.deltaY*c0,Q=Math.min(s0,Math.max(h0,w*(1+q))),B=g.getBoundingClientRect(),J=$.clientX-B.left,K=$.clientY-B.top;s=J-(J-s)/w*Q,c=K-(K-c)/w*Q,w=Q,Z0(),Q5()},{passive:!1}),g.addEventListener("mousedown",($)=>{if(A0(),K5(),$.button!==0)return;let q=$.target;if(q!==g&&q!==V0&&!q.classList.contains("vignette"))return;$.preventDefault(),Z={type:"pan",startMX:$.clientX,startMY:$.clientY,startX:0,startY:0,startW:0,startH:0,startPanX:s,startPanY:c},g.classList.add("grabbing")}),window.addEventListener("mousemove",V5),window.addEventListener("mouseup",G5),g.addEventListener("contextmenu",($)=>{$.preventDefault();let q=$.target;if(q!==g&&q!==V0&&!q.classList.contains("vignette"))return;let Q=e0($.clientX,$.clientY);C0=M(Q.x),X0=M(Q.y),q0.style.left=$.clientX+"px",q0.style.top=$.clientY+"px",q0.classList.add("open")}),q0.querySelectorAll("button[data-type]").forEach(($)=>{$.addEventListener("click",()=>{let q=$.dataset.type;W0(q,C0,X0),A0()})}),document.addEventListener("mousedown",($)=>{if(!$.target.closest(".context-menu"))A0()}),Z0()}function A0(){q0.classList.remove("open")}function K5(){document.getElementById("add-menu").classList.remove("open")}function V5($){if(!Z)return;$.preventDefault();let q=$.clientX-Z.startMX,Q=$.clientY-Z.startMY;if(Z.type==="pan"){s=Z.startPanX+q,c=Z.startPanY+Q,Z0();return}if(Z.type==="drag"&&Z.chart){let B=Z.chart,J=M(Z.startX+q/w),K=M(Z.startY+Q/w),j={x:J,y:K,w:B.w,h:B.h};if(!d(j,B.id))B.x=J,B.y=K;else{let L=!d({x:J,y:B.y,w:B.w,h:B.h},B.id),F=!d({x:B.x,y:K,w:B.w,h:B.h},B.id);if(L)B.x=J;if(F)B.y=K}w0(B);return}if(Z.type==="resize"&&Z.chart){let{chart:B,handle:J}=Z,K=B.x,j=B.y,L=B.w,F=B.h,G=q/w,R=Q/w;if(J.includes("e"))L=M(Math.max(S0,Z.startW+G));if(J.includes("w")){let U=M(Math.max(S0,Z.startW-G));K=M(Z.startX+(Z.startW-U)),L=U}if(J.includes("s"))F=M(Math.max(Y0,Z.startH+R));if(J.includes("n")){let U=M(Math.max(Y0,Z.startH-R));j=M(Z.startY+(Z.startH-U)),F=U}if(!d({x:K,y:j,w:L,h:F},B.id))B.x=K,B.y=j,B.w=L,B.h=F;else{let U={x:K,y:B.y,w:L,h:B.h},_={x:B.x,y:j,w:B.w,h:F};if(!d(U,B.id))B.x=K,B.w=L;if(!d(_,B.id))B.y=j,B.h=F}w0(B),N5(B);return}}function G5($){if(!Z)return;if(Z.type==="pan")g.classList.remove("grabbing");if(Z.type==="drag"&&Z.chart)Z.chart.el.classList.remove("dragging");if(Z.type==="resize"&&Z.chart)Z.chart.el.classList.remove("resizing");Z=null}function z0($,q){let Q=g.getBoundingClientRect(),B=M((-s+Q.width/2)/w-$/2),J=M((-c+Q.height/2)/w-q/2);if(!d({x:B,y:J,w:$,h:q}))return{x:B,y:J};for(let K=K0;K<4000;K+=K0)for(let j=-K;j<=K;j+=K0){if(!d({x:B+j,y:J-K,w:$,h:q}))return{x:B+j,y:J-K};if(!d({x:B+j,y:J+K,w:$,h:q}))return{x:B+j,y:J+K};if(!d({x:B-K,y:J+j,w:$,h:q}))return{x:B-K,y:J+j};if(!d({x:B+K,y:J+j,w:$,h:q}))return{x:B+K,y:J+j}}return{x:B,y:J}}function W0($,q,Q){let B="tile-"+M0++,J=M(k0),K=M(H0),j=M(q-J/2),L=M(Q-K/2);if(d({x:j,y:L,w:J,h:K})){let k=z0(J,K);j=k.x,L=k.y}let F={id:B,chartId:"",name:"Chart "+(M0-1),x:j,y:L,w:J,h:K,type:$,el:null},G=U5(F);F.el=G,V0.appendChild(G),h.push(F);let R=G.querySelector(".tile-body"),V=document.getElementById("series-count"),U=Math.max(1,Math.min(100,parseInt(V?.value||"3"))),_=[];for(let k=0;k<U;k++){let D=a0(),I=P0();_.push({label:`Series ${String.fromCharCode(65+k)}`,color:I,x:D.x,y:D.y})}let P={type:$,container:R,series:_,formatX:B5,formatY:$5,zoomMode:"both",showTooltip:!0,bgColor:[0.055,0.055,0.086],textColor:"#8888a0",gridColor:"#262638"};try{F.chartId=x.create(P)}catch(k){console.error("Failed to create chart:",k),G.remove(),h.splice(h.indexOf(F),1);return}}function N0($){let q=M(k0),Q=M(H0),B=z0(q,Q);W0($,B.x+q/2,B.y+Q/2)}function v0($){let q=h.findIndex((B)=>B.id===$);if(q<0)return;let Q=h[q];if(Q.chartId)x.destroy(Q.chartId);Q.el.remove(),h.splice(q,1)}function L5(){for(let $ of[...h])v0($.id)}function F5($){let Q=()=>{let B=J5($.value,"600 13px -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif");$.style.width=Math.max(20,Math.ceil(B)+14)+"px"};return $.addEventListener("input",Q),$.addEventListener("blur",Q),Q(),Q}function U5($){let q=document.createElement("div");q.className="chart-tile",q.dataset.tileId=$.id,q.style.left=$.x+"px",q.style.top=$.y+"px",q.style.width=$.w+"px",q.style.height=$.h+"px";let Q=$.type.charAt(0).toUpperCase()+$.type.slice(1),B=$.type==="scatter"?`<div class="tile-point-size">
        <input type="range" min="1" max="12" value="3" class="point-size-slider" title="Point size">
        <span class="point-size-label">3px</span>
      </div>`:"";q.innerHTML=`
    <div class="tile-header">
      <input class="tile-name" value="${$.name}" spellcheck="false" />
      <div class="tile-tools">
        <span class="tile-type">${Q}</span>
        <span class="tile-points">1k</span>
        ${B}
        <button class="tile-btn" data-action="reset" title="Reset view">&#x2318;</button>
        <button class="tile-btn" data-action="data" title="Load data source">
          <svg viewBox="0 0 16 16" fill="none" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round">
            <path d="M8 3v8M5 8l3 3 3-3"/>
            <path d="M3 12h10"/>
          </svg>
        </button>
        <button class="tile-btn danger" data-action="close" title="Remove chart">&times;</button>
      </div>
    </div>
    <div class="tile-body"></div>
    <div class="resize-handle resize-n" data-handle="n"></div>
    <div class="resize-handle resize-s" data-handle="s"></div>
    <div class="resize-handle resize-e" data-handle="e"></div>
    <div class="resize-handle resize-w" data-handle="w"></div>
    <div class="resize-handle resize-ne" data-handle="ne"></div>
    <div class="resize-handle resize-nw" data-handle="nw"></div>
    <div class="resize-handle resize-se" data-handle="se"></div>
    <div class="resize-handle resize-sw" data-handle="sw"></div>
  `,q.addEventListener("wheel",(G)=>G.stopPropagation());let J=q.querySelector(".tile-name"),K=F5(J);J.addEventListener("input",()=>{$.name=J.value}),J.addEventListener("mousedown",(G)=>G.stopPropagation()),q._resizeName=K;let j=q.querySelector(".point-size-slider"),L=q.querySelector(".point-size-label");if(j&&L)j.addEventListener("input",()=>{let G=parseInt(j.value);if(L.textContent=G+"px",$.chartId)x.setPointSize($.chartId,G)}),j.addEventListener("mousedown",(G)=>G.stopPropagation());return q.querySelector(".tile-header").addEventListener("mousedown",(G)=>{let R=G.target;if(R.tagName==="INPUT"||R.tagName==="BUTTON"||R.closest("button"))return;if(G.button!==0)return;G.preventDefault(),G.stopPropagation(),q.classList.add("dragging"),Z={type:"drag",chart:$,startMX:G.clientX,startMY:G.clientY,startX:$.x,startY:$.y,startW:$.w,startH:$.h,startPanX:s,startPanY:c}}),q.querySelectorAll(".resize-handle").forEach((G)=>{G.addEventListener("mousedown",(R)=>{R.preventDefault(),R.stopPropagation();let V=G.dataset.handle;q.classList.add("resizing"),Z={type:"resize",chart:$,handle:V,startMX:R.clientX,startMY:R.clientY,startX:$.x,startY:$.y,startW:$.w,startH:$.h,startPanX:s,startPanY:c}})}),q.addEventListener("click",(G)=>{let R=G.target.closest("[data-action]");if(!R)return;let V=R.dataset.action;if(V==="close")v0($.id);if(V==="data")R5($);if(V==="reset"&&$.chartId)x.resetView($.chartId)}),q}function m0($,q){let Q=$.el.querySelector(".tile-points");if(Q)Q.textContent=q5(q)}function w0($){$.el.style.left=$.x+"px",$.el.style.top=$.y+"px"}function N5($){$.el.style.width=$.w+"px",$.el.style.height=$.h+"px"}function R5($){R0=$,G0=null;let q=document.getElementById("data-modal"),Q=document.getElementById("data-url"),B=document.getElementById("data-transform"),J=document.getElementById("data-error");Q.value="",B.value="",J.classList.add("hidden"),J.textContent="";let K=document.getElementById("presets");K.innerHTML="";let j=[],L=new Map;for(let F of E0){if(!L.has(F.category))j.push(F.category),L.set(F.category,[]);L.get(F.category).push(F)}for(let F of j){let G=document.createElement("div");G.className="preset-category";let R=document.createElement("div");R.className="preset-category-header",R.textContent=F,G.appendChild(R);let V=document.createElement("div");V.className="preset-category-items";for(let U of L.get(F)){let _=document.createElement("button");_.className="preset-btn",_.textContent=U.name,_.addEventListener("click",()=>{Q.value=U.url,B.value=U.transform,G0=U.name,J.classList.add("hidden"),K.querySelectorAll(".preset-btn").forEach((P)=>P.classList.remove("active")),_.classList.add("active")}),V.appendChild(_)}G.appendChild(V),K.appendChild(G)}q.classList.add("open")}async function _5($,q){try{let Q=null;if(q.url){let j=await fetch(q.url);if(!j.ok)throw new Error(`Fetch failed: HTTP ${j.status}`);Q=await j.json()}let J=new Function("data","url",q.transform)(Q,q.url);if(!J||!Array.isArray(J.x)||!Array.isArray(J.y))return;if(J.x.length===0)return;x.updateSeries($.chartId,[{label:q.name,color:P0(),x:J.x,y:J.y}]),x.resetView($.chartId),m0($,J.x.length),$.name=q.name;let K=$.el.querySelector(".tile-name");if(K){K.value=$.name;let j=$.el._resizeName;if(j)j()}}catch(Q){console.warn(`Failed to load preset "${q.name}":`,Q)}}function j0(){document.getElementById("data-modal").classList.remove("open"),R0=null,G0=null}async function A5(){if(!R0)return;let $=R0,q=document.getElementById("data-url").value.trim(),Q=document.getElementById("data-transform").value.trim(),B=document.getElementById("data-error");if(B.classList.add("hidden"),!Q){B.textContent="Please provide a transform function.",B.classList.remove("hidden");return}try{let J=null;if(q){let F=await fetch(q);if(!F.ok)throw new Error(`Fetch failed: HTTP ${F.status} ${F.statusText}`);J=await F.json()}let j=new Function("data","url",Q)(J,q);if(!j||!Array.isArray(j.x)||!Array.isArray(j.y))throw new Error("Transform must return { x: number[], y: number[] }");if(j.x.length!==j.y.length)throw new Error(`x and y arrays must be same length (got ${j.x.length} and ${j.y.length})`);if(j.x.length===0)throw new Error("Returned data is empty");if(x.updateSeries($.chartId,[{label:$.name,color:P0(),x:j.x,y:j.y}]),x.resetView($.chartId),m0($,j.x.length),/^Chart \d+$/.test($.name)&&G0){$.name=G0;let F=$.el.querySelector(".tile-name");if(F){F.value=$.name;let G=$.el._resizeName;if(G)G()}}j0()}catch(J){B.textContent=J.message||String(J),B.classList.remove("hidden")}}function E5(){document.getElementById("modal-close").addEventListener("click",j0),document.getElementById("data-cancel").addEventListener("click",j0),document.getElementById("data-load").addEventListener("click",A5),document.getElementById("data-modal").addEventListener("mousedown",($)=>{if($.target.classList.contains("modal-overlay"))j0()}),document.addEventListener("keydown",($)=>{if($.key==="Escape"){if(document.getElementById("data-modal").classList.contains("open"))j0()}})}var u0=0;function Z5($,q="error"){let Q=document.getElementById("toast");Q.textContent=$,Q.style.background=q==="success"?"var(--success)":"var(--danger)",Q.classList.remove("hidden"),clearTimeout(u0),u0=window.setTimeout(()=>Q.classList.add("hidden"),3000)}function k5(){let $=document.getElementById("add-btn"),q=document.getElementById("add-menu");$.addEventListener("click",(J)=>{J.stopPropagation(),q.classList.toggle("open")}),q.querySelectorAll("button[data-type]").forEach((J)=>{J.addEventListener("click",()=>{let K=J.dataset.type;N0(K),q.classList.remove("open")})}),document.addEventListener("mousedown",(J)=>{if(!J.target.closest("#add-dropdown"))q.classList.remove("open")});let Q=document.getElementById("sync-toggle"),B=document.getElementById("sync-label");Q.addEventListener("change",()=>{let J=Q.checked;x.setSyncViews(J),B.textContent=J?"Synced":"Sync Off"}),document.getElementById("add-random-5").addEventListener("click",()=>{let J=["line","scatter","bar"];for(let K=0;K<5;K++){let j=E0[Math.floor(Math.random()*E0.length)],L=j.type||J[Math.floor(Math.random()*J.length)],F=M(k0),G=M(H0),R=z0(F,G);W0(L,R.x+F/2,R.y+G/2);let V=h[h.length-1];if(V)_5(V,j)}}),document.getElementById("clear-all").addEventListener("click",L5)}function H5(){let $=0,q=new MessageChannel,Q=0,B=0;q.port1.onmessage=()=>{$=performance.now()-Q;let K=performance.now();if(K-B>=120){B=K;let j=(L)=>L<1?L.toFixed(2)+"ms":L.toFixed(1)+"ms";document.getElementById("main-ms").textContent=j($)}};function J(){requestAnimationFrame(()=>{Q=performance.now(),q.port2.postMessage(null),J()})}J()}function P5(){x.onStats(($)=>{document.getElementById("active").textContent=$.active.toString(),document.getElementById("total").textContent=$.total.toString()})}async function z5(){if(x=A.getInstance(),!await x.init()){Z5("WebGPU not available. Please use a supported browser.","error");return}x.setTheme(!0),j5(),k5(),E5(),H5(),P5(),setTimeout(()=>{N0("line"),N0("scatter"),N0("bar")},100)}if(location.hostname==="localhost"||location.hostname==="127.0.0.1"){let $=new WebSocket(`ws://${location.host}/__hot`);$.onmessage=(q)=>{if(q.data==="reload")location.reload()}}z5();
