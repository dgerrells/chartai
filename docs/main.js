var I0=Object.create;var{getPrototypeOf:P0,defineProperty:A0,getOwnPropertyNames:y0}=Object;var C0=Object.prototype.hasOwnProperty;var S0=($,G,J)=>{J=$!=null?I0(P0($)):{};let F=G||!$||!$.__esModule?A0(J,"default",{value:$,enumerable:!0}):J;for(let q of y0($))if(!C0.call(F,q))A0(F,q,{get:()=>$[q],enumerable:!0});return F};var Y0=(($)=>typeof require!=="undefined"?require:typeof Proxy!=="undefined"?new Proxy($,{get:(G,J)=>(typeof require!=="undefined"?require:G)[J]}):$)(function($){if(typeof require!=="undefined")return require.apply(this,arguments);throw Error('Dynamic require of "'+$+'" is not supported')});var G0=[];function Q0($){if(!G0.some((G)=>G.name===$.name))G0.push($)}class L{static instance=null;static MARGIN={left:55,right:10,top:8,bottom:45};static HOVER_MAX_DISTANCE_PX=50;static MIN_ZOOM=0.1;static MAX_ZOOM=1e7;static DEFAULT_LABEL_SIZE=12;static DEFAULT_FONT='-apple-system, BlinkMacSystemFont, "Segoe UI", system-ui, sans-serif';static resizeCanvas($,G,J){let F=devicePixelRatio||1;if($.width=Math.round(G*F),$.height=Math.round(J*F),$ instanceof HTMLCanvasElement)$.style.width=`${G}px`,$.style.height=`${J}px`}worker=null;charts=new Map;chartIdCounter=0;_syncViews=!1;_isDark=!1;statsCallbacks=[];currentStats={fps:0,renderMs:0,total:0,active:0};visibilityObserver;resizeObserver;constructor(){this._isDark=document.documentElement.classList.contains("dark"),this.visibilityObserver=new IntersectionObserver(($)=>{for(let G of $){let J=G.target.dataset.chartId;if(J){let F=this.charts.get(J);if(F){if(F.visible=G.isIntersecting,this.worker?.postMessage({type:"set-visibility",id:J,visible:G.isIntersecting}),G.isIntersecting)this.drawChart(F)}}}},{threshold:0.01}),this.resizeObserver=new ResizeObserver(($)=>{for(let G of $){let J=G.target.dataset.chartId;if(!J)continue;let F=this.charts.get(J);if(!F)continue;let{width:q,height:j}=G.contentRect;if(q<=0||j<=0)continue;F.width=q,F.height=j;let E=devicePixelRatio||1;this.worker?.postMessage({type:"resize",id:J,width:Math.round(q*E),height:Math.round(j*E)}),L.resizeCanvas(F.backCanvas,q,j),L.resizeCanvas(F.axisCanvas,q,j),this.drawChart(F)}})}static getInstance(){if(!L.instance)L.instance=new L;return L.instance}get isDark(){return this._isDark}get syncViews(){return this._syncViews}async init(){if(this.worker)return!0;return new Promise(($)=>{import("./worker-inline.js").then(({WORKER_CODE:G})=>{let J=new Blob([G],{type:"application/javascript"}),F=URL.createObjectURL(J);this.worker=new Worker(F,{type:"module"}),this.setupWorkerHandlers($)}).catch(()=>{let G=new URL("./gpu-worker.js",import.meta.url);this.worker=new Worker(G,{type:"module"}),this.setupWorkerHandlers($)})})}setupWorkerHandlers($){if(!this.worker)return;this.worker.onmessage=(G)=>{let{type:J,...F}=G.data;switch(J){case"gpu-ready":$(!0);break;case"error":console.error("ChartManager GPU Error:",F.message),$(!1);break;case"stats":this.currentStats={fps:F.fps,renderMs:F.renderMs,total:F.totalCharts,active:F.activeCharts};for(let q of this.statsCallbacks)q(this.currentStats);break;case"bounds-update":{let q=this.charts.get(F.id);if(q)q.bounds={minX:F.minX,maxX:F.maxX,minY:F.minY,maxY:F.maxY},this.drawChart(q);break}default:break}},this.worker.onerror=(G)=>{console.error("ChartManager Worker Error:",G),$(!1)},this.worker.postMessage({type:"init",isDark:this._isDark})}create($){if(!this.worker)throw new Error("ChartManager not initialized. Call init() first.");let G=`chart-${++this.chartIdCounter}`,J=document.createElement("div");J.dataset.chartId=G,J.style.cssText="width: 100%; height: 100%; position: relative;";let F=document.createElement("div");F.dataset.chartId=G,F.style.cssText="width: 100%; height: 100%; position: relative;";let q=document.createElement("canvas");q.style.cssText="position: absolute; inset: 0; width: 100%; height: 100%; pointer-events: none;";let j=document.createElement("canvas");j.style.cssText="position: absolute; inset: 0; width: 100%; height: 100%; pointer-events: auto; z-index: 1;";let E=document.createElement("canvas");E.style.cssText="position: absolute; inset: 0; width: 100%; height: 100%; pointer-events: none; z-index: 2;",F.appendChild(q),F.appendChild(j),F.appendChild(E),J.appendChild(F),$.container.appendChild(J);let K;try{K=j.transferControlToOffscreen()}catch(B){throw console.error(`ChartManager: Failed to create offscreen canvas for ${G}:`,B),new Error(`Failed to create chart ${G}: ${B}`)}let V=F.getBoundingClientRect(),N=V.width||400,O=V.height||200;if(L.resizeCanvas(K,N,O),L.resizeCanvas(q,N,O),L.resizeCanvas(E,N,O),$.bgColor){let[B,H,A]=$.bgColor;F.style.background=`rgb(${Math.round(B*255)},${Math.round(H*255)},${Math.round(A*255)})`}let Q={id:G,config:$,el:J,backCanvas:q,axisCanvas:E,width:N,height:O,series:[],bounds:{minX:0,maxX:1,minY:0,maxY:1},view:{panX:0,panY:0,zoomX:1,zoomY:1},zoomMode:$.zoomMode||"both",visible:!0,dragging:!1,bgColor:$.bgColor,textColor:$.textColor,gridColor:$.gridColor,fontFamily:$.fontFamily,momentum:null,findNearestPoint(B,H,A,M){if(this.series.length===0)return null;let W=B/A,f=H/M,S=this.bounds.maxX-this.bounds.minX,g=this.bounds.maxY-this.bounds.minY,k=S/this.view.zoomX,u=g/this.view.zoomY,d=this.bounds.minX+this.view.panX*S,x=this.bounds.minY+this.view.panY*g,m=d+W*k,o=x+(1-f)*u,b=-1,U=-1,w=1/0,y=1/0;for(let r=0;r<this.series.length;r++){let _=this.series[r],T=_.rawX.length;if(T===0)continue;let z=0,Z=T-1;while(z<Z){let l=z+Z>>1;if(_.rawX[l]<m)z=l+1;else Z=l}let Y=z;if(z>0){let l=Math.abs(_.rawX[z]-m);if(Math.abs(_.rawX[z-1]-m)<l)Y=z-1}let C=Math.abs(_.rawX[Y]-m),X=Math.abs(_.rawY[Y]-o);if(C<w||C===w&&X<y)w=C,y=X,b=r,U=Y}if(b===-1)return null;let I=this.series[b],D=(I.rawX[U]-d)/k*A;if(Math.abs(D-B)>L.HOVER_MAX_DISTANCE_PX)return null;return{x:I.rawX[U],y:I.rawY[U],index:U,screenX:B,screenY:H,seriesIndex:b,seriesLabel:I.label}}};this.charts.set(G,Q);let R=$.type==="bar"?"box":$.type;this.worker.postMessage({type:"register-chart",id:G,canvas:K,chartType:R,pointSize:$.pointSize??3,maxSamplesPerPixel:$.maxSamplesPerPixel??1e4,bgColor:$.bgColor??null},[K]),this.visibilityObserver.observe(J),this.resizeObserver.observe(F);for(let B of G0)B.install?.(Q,F);return this.updateSeries(G,$.series),G}destroy($){let G=this.charts.get($);if(!G)return;for(let F of G0)F.uninstall?.(G);if(G.momentum)cancelAnimationFrame(G.momentum);this.visibilityObserver.unobserve(G.el);let J=G.el.querySelector(".gpu-chart-canvas-wrap");if(J)this.resizeObserver.unobserve(J);G.el.remove(),this.worker?.postMessage({type:"unregister-chart",id:$}),this.charts.delete($)}updateSeries($,G){let J=this.charts.get($);if(!J||!this.worker)return;if(G.length===0)return;J.series=G.map((Q)=>{let R=Q.x.length;if(R===0)return{label:Q.label,color:Q.color,rawX:[],rawY:[]};let B=Array.from({length:R},(H,A)=>A);return B.sort((H,A)=>Q.x[H]-Q.x[A]),{label:Q.label,color:Q.color,rawX:B.map((H)=>Q.x[H]),rawY:B.map((H)=>Q.y[H])}});let F=1/0,q=-1/0,j=1/0,E=-1/0;for(let Q of J.series)for(let R=0;R<Q.rawX.length;R++){if(Q.rawX[R]<F)F=Q.rawX[R];if(Q.rawX[R]>q)q=Q.rawX[R];if(Q.rawY[R]<j)j=Q.rawY[R];if(Q.rawY[R]>E)E=Q.rawY[R]}let K=(q-F)*0.05||1,V=(E-j)*0.1||1;F-=K,q+=K,j-=V,E+=V;let N=J.config.defaultBounds;if(N){if(N.minX!==void 0)F=N.minX;if(N.maxX!==void 0)q=N.maxX;if(N.minY!==void 0)j=N.minY;if(N.maxY!==void 0)E=N.maxY}J.bounds={minX:F,maxX:q,minY:j,maxY:E};let O=J.series.map((Q)=>({label:Q.label,colorR:Q.color.r,colorG:Q.color.g,colorB:Q.color.b,dataX:new Float32Array(Q.rawX),dataY:new Float32Array(Q.rawY)}));this.worker.postMessage({type:"update-series",id:$,series:O,bounds:J.bounds},O.flatMap((Q)=>[Q.dataX.buffer,Q.dataY.buffer])),this.sendViewTransform(J),this.drawChart(J)}setPointSize($,G){if(!this.charts.get($))return;this.worker?.postMessage({type:"set-point-size",id:$,pointSize:Math.max(1,Math.min(8,Math.round(G)))})}setMaxSamplesPerPixel($,G){if(!this.charts.get($))return;this.worker?.postMessage({type:"set-max-samples",id:$,maxSamplesPerPixel:Math.max(0,G|0)})}setStyle($,G){let J=this.charts.get($);if(!J)return;if(G.bgColor!==void 0)J.bgColor=G.bgColor;if(G.textColor!==void 0)J.textColor=G.textColor;if(G.gridColor!==void 0)J.gridColor=G.gridColor;if(G.fontFamily!==void 0)J.fontFamily=G.fontFamily;if(G.bgColor!==void 0){let F=J.el.querySelector(".gpu-chart-canvas-wrap");if(F){let[q,j,E]=G.bgColor;F.style.background=`rgb(${Math.round(q*255)},${Math.round(j*255)},${Math.round(E*255)})`}this.worker?.postMessage({type:"set-style",id:$,bgColor:G.bgColor})}this.drawChart(J)}setZoomMode($,G){let J=this.charts.get($);if(J)J.zoomMode=G}getChartCount(){return this.charts.size}getZoomMode($){return this.charts.get($)?.zoomMode||"both"}setSyncViews($){this._syncViews=$}setTheme($){this._isDark=$,this.worker?.postMessage({type:"theme",isDark:$});for(let G of this.charts.values())this.drawChart(G)}onStats($){return this.statsCallbacks.push($),()=>{let G=this.statsCallbacks.indexOf($);if(G>=0)this.statsCallbacks.splice(G,1)}}getStats(){return{...this.currentStats}}resetView($){let G=this.charts.get($);if(!G)return;if(G.momentum)cancelAnimationFrame(G.momentum),G.momentum=null;let J=G.view.panX,F=G.view.panY,q=G.view.zoomX,j=G.view.zoomY,E=performance.now(),K=()=>{let V=Math.min(1,(performance.now()-E)/300),N=1-Math.pow(1-V,3);if(G.view.panX=J*(1-N),G.view.panY=F*(1-N),G.view.zoomX=q+(1-q)*N,G.view.zoomY=j+(1-j)*N,this.sendViewTransform(G),this.drawChart(G),this._syncViews)this.syncAllViews(G);if(V<1)requestAnimationFrame(K)};requestAnimationFrame(K)}sendViewTransform($){this.worker?.postMessage({type:"view-transform",id:$.id,panX:$.view.panX,panY:$.view.panY,zoomX:$.view.zoomX,zoomY:$.view.zoomY})}syncAllViews($){let G=[];for(let J of this.charts.values())if(J.id!==$.id)J.view={...$.view},G.push({id:J.id}),this.drawChart(J);if(G.length>0)this.worker?.postMessage({type:"batch-view-transform",panX:$.view.panX,panY:$.view.panY,zoomX:$.view.zoomX,zoomY:$.view.zoomY,transforms:G})}drawChart($){if(!$.visible)return;let G=devicePixelRatio||1,J=$.backCanvas.getContext("2d");if(J){J.clearRect(0,0,$.backCanvas.width,$.backCanvas.height),J.save(),J.scale(G,G);for(let q of G0)q.beforeDraw?.(J,$);J.restore()}let F=$.axisCanvas.getContext("2d");if(F){F.clearRect(0,0,$.axisCanvas.width,$.axisCanvas.height),F.save(),F.scale(G,G);for(let q of G0)q.afterDraw?.(F,$);F.restore()}}}var E0=($,G,J)=>{let F=G-$;if(F<=0)return[$];let q=F/J,j=10**Math.floor(Math.log10(q)),E=q/j,K=j*(E<=1.5?1:E<=3?2:E<=7?5:10),V=[];for(let N=Math.ceil($/K)*K;N<=G;N+=K)V.push(N);return V},H0=($)=>{let G=L.getInstance(),J=$.width,F=$.height,q=L.MARGIN,{bounds:j,view:E}=$,K=j.maxX-j.minX,V=j.maxY-j.minY,N=K/E.zoomX,O=V/E.zoomY,Q=j.minX+E.panX*K,R=j.minY+E.panY*V,B=$.bgColor??(G.isDark?[0.11,0.11,0.12]:[0.98,0.98,0.98]);return{w:J,h:F,m:q,rx:N,ry:O,mx:Q,my:R,bg:`${Math.round(B[0]*255)},${Math.round(B[1]*255)},${Math.round(B[2]*255)}`,font:$.fontFamily??L.DEFAULT_FONT,text:$.textColor??(G.isDark?"#c0c0c0":"#333333"),grid:$.gridColor??(G.isDark?"rgba(255,255,255,0.06)":"rgba(0,0,0,0.06)")}},z0={name:"labels",beforeDraw($,G){let{w:J,h:F,m:q,rx:j,ry:E,mx:K,my:V,grid:N}=H0(G);$.strokeStyle=N,$.lineWidth=1,$.beginPath(),E0(V,V+E,7).forEach((O)=>{let Q=F*(1-(O-V)/E);if(Q>5&&Q<F-q.bottom-5)$.moveTo(q.left,Q),$.lineTo(J,Q)}),E0(K,K+j,8).forEach((O)=>{let Q=J*((O-K)/j);if(Q>q.left&&Q<J)$.moveTo(Q,0),$.lineTo(Q,F-q.bottom)}),$.stroke()},afterDraw($,G){let{w:J,h:F,m:q,rx:j,ry:E,mx:K,my:V,bg:N,font:O,text:Q}=H0(G),{formatX:R=String,formatY:B=String,labelSize:H=L.DEFAULT_LABEL_SIZE}=G.config,A=(M,W,f,S,g)=>{let k=M==="left"?$.createLinearGradient(W,0,W+S,0):$.createLinearGradient(0,f,0,f+g),u=M==="left"?[1,0.7,0.2,0.05,0]:[0,0.05,0.2,0.7,1];[0,0.35,0.55,0.7,1].forEach((d,x)=>k.addColorStop(d,`rgba(${N},${u[x]})`)),$.fillStyle=k,$.fillRect(W,f,S,g)};A("left",0,0,q.left+20,F),A("bottom",0,F-q.bottom-20,J,q.bottom+20),$.font=`${H}px ${O}`,$.fillStyle=Q,$.textAlign="right",$.textBaseline="middle",E0(V,V+E,7).forEach((M)=>{let W=F*(1-(M-V)/E);if(W>5&&W<F-q.bottom-5)$.fillText(B(M),q.left-5,W)}),$.textAlign="right",$.textBaseline="top",E0(K,K+j,8).forEach((M)=>{let W=J*((M-K)/j);if(W<q.left-10||W>J+30)return;$.save(),$.translate(W,F-q.bottom+5),$.rotate(-Math.PI/14),$.fillText(R(M),0,0),$.restore()})}};function Z0($={}){let G=$.momentumDecay??0.9,J=new WeakMap;return{name:"zoom",install(F,q){let j=q.style.touchAction,E=q.style.userSelect,K=q.style.webkitUserSelect;q.style.touchAction="none",q.style.userSelect="none",q.style.webkitUserSelect="none";let V=L.getInstance(),N=new AbortController,O={lastX:0,lastY:0,velX:0,velY:0,abort:N,originalTouchAction:j,originalUserSelect:E,originalWebkitUserSelect:K,el:q};J.set(F,O);let Q=[],R="none",B=0,H=0,A=0,M=0,W=0,f=10,S=10,g=500,k=null,u=0,d=1,x=1,m=0.5,o=0.5,b=0,U=0,w=0,y=null,I=0,h=1,D=()=>{if(V.sendViewTransform(F),V.drawChart(F),V.syncViews)V.syncAllViews(F)},$0=()=>{if(F.momentum)cancelAnimationFrame(F.momentum);let _=()=>{if(b*=G,U*=G,Math.abs(b)>0.00005||Math.abs(U)>0.00005){if(F.zoomMode!=="none"&&(F.zoomMode==="both"||F.zoomMode==="x-only"))F.view.panX-=b/F.view.zoomX;if(F.zoomMode!=="none"&&(F.zoomMode==="both"||F.zoomMode==="y-only"))F.view.panY+=U/F.view.zoomY;D(),F.momentum=requestAnimationFrame(_)}else F.momentum=null};F.momentum=requestAnimationFrame(_)};q.addEventListener("pointerdown",(_)=>{if(F.momentum)cancelAnimationFrame(F.momentum),F.momentum=null;if(Q.push(_),q.setPointerCapture(_.pointerId),Q.length===1)if(R="detecting",B=_.clientX,H=_.clientY,A=_.clientX,M=_.clientY,b=U=0,W=performance.now(),y=null,_.pointerType==="touch")k=window.setTimeout(()=>{if(R==="detecting")R="press",F.dragging=!1},g);else{let T=q.getBoundingClientRect(),z=_.clientX-T.left,Z=_.clientY-T.top,Y=L.MARGIN,C=z<Y.left,X=Z>T.height-Y.bottom;if(C&&!X)y="y",I=_.clientY,h=F.view.zoomY,F.dragging=!0;else if(X&&!C)y="x",I=_.clientX,h=F.view.zoomX,F.dragging=!0;else F.dragging=!0}else if(Q.length===2){if(k)clearTimeout(k),k=null;if(R="pinch",F.dragging=!1,_.pointerType==="touch")_.preventDefault();let T=q.getBoundingClientRect(),z=Q[1].clientX-Q[0].clientX,Z=Q[1].clientY-Q[0].clientY;u=Math.hypot(z,Z),d=F.view.zoomX,x=F.view.zoomY,m=((Q[0].clientX+Q[1].clientX)/2-T.left)/T.width,o=1-((Q[0].clientY+Q[1].clientY)/2-T.top)/T.height}},{passive:!1,signal:N.signal}),q.addEventListener("pointermove",(_)=>{let T=Q.findIndex((z)=>z.pointerId===_.pointerId);if(T>=0)Q[T]=_;if(Q.length===1){let z=Math.hypot(_.clientX-B,_.clientY-H);if(R==="detecting"&&z>f){if(R="pan",F.dragging=!0,k)clearTimeout(k),k=null}if(R==="press")return;if(y&&_.pointerType!=="touch"){if(y==="x"){let Z=_.clientX-I,Y=Math.exp(Z/200),C=Math.max(L.MIN_ZOOM,Math.min(L.MAX_ZOOM,h*Y)),X=F.view.panX+0.5/h;F.view.zoomX=C,F.view.panX=X-0.5/C,D();return}else if(y==="y"){let Z=I-_.clientY,Y=Math.exp(Z/200),C=Math.max(L.MIN_ZOOM,Math.min(L.MAX_ZOOM,h*Y)),X=F.view.panY+0.5/h;F.view.zoomY=C,F.view.panY=X-0.5/C,D();return}}if(R==="pan"||F.dragging&&!y){let Z=q.getBoundingClientRect(),Y=(_.clientX-A)/Z.width,C=(_.clientY-M)/Z.height,X=performance.now();if(X-W<100)b=b*0.3+Y*0.7,U=U*0.3+C*0.7;if(W=X,F.zoomMode!=="none"&&(F.zoomMode==="both"||F.zoomMode==="x-only"))F.view.panX-=Y/F.view.zoomX;if(F.zoomMode!=="none"&&(F.zoomMode==="both"||F.zoomMode==="y-only"))F.view.panY+=C/F.view.zoomY;A=_.clientX,M=_.clientY,D()}}else if(Q.length===2&&R==="pinch"){if(_.pointerType==="touch")_.preventDefault();let z=q.getBoundingClientRect(),Z=Q[1].clientX-Q[0].clientX,Y=Q[1].clientY-Q[0].clientY,C=Math.hypot(Z,Y),X=((Q[0].clientX+Q[1].clientX)/2-z.left)/z.width,l=1-((Q[0].clientY+Q[1].clientY)/2-z.top)/z.height,q0=C-u,J0=Math.exp(q0/300);if(F.zoomMode!=="none"&&(F.zoomMode==="both"||F.zoomMode==="x-only")){let n=Math.max(L.MIN_ZOOM,Math.min(L.MAX_ZOOM,d*J0)),i=F.view.panX+X/F.view.zoomX;F.view.zoomX=n,F.view.panX=i-X/n}if(F.zoomMode!=="none"&&(F.zoomMode==="both"||F.zoomMode==="y-only")){let n=Math.max(L.MIN_ZOOM,Math.min(L.MAX_ZOOM,x*J0)),i=F.view.panY+l/F.view.zoomY;F.view.zoomY=n,F.view.panY=i-l/n}D()}},{passive:!1,signal:N.signal});let r=(_)=>{if(Q=Q.filter((T)=>T.pointerId!==_.pointerId),q.releasePointerCapture(_.pointerId),k)clearTimeout(k),k=null;if(Q.length===0){let z=Math.hypot(_.clientX-B,_.clientY-H)<S&&R!=="pan";if(z&&_.pointerType==="touch"){let Z=Date.now();if(Z-w<300)V.resetView(F.id),w=0;else w=Z}if(z&&_.pointerType!=="touch"){let Z=Date.now();if(Z-w<300)V.resetView(F.id),w=0;else w=Z}if(R==="pan"&&(Math.abs(b)>0.001||Math.abs(U)>0.001))$0();R="none",F.dragging=!1,y=null}else if(Q.length===1)R="detecting",B=Q[0].clientX,H=Q[0].clientY,A=Q[0].clientX,M=Q[0].clientY};q.addEventListener("pointerup",r,{signal:N.signal}),q.addEventListener("pointercancel",r,{signal:N.signal}),q.addEventListener("wheel",(_)=>{if(_.preventDefault(),F.momentum)cancelAnimationFrame(F.momentum),F.momentum=null;let T=q.getBoundingClientRect(),z=_.clientX-T.left,Z=_.clientY-T.top,Y=z/T.width,C=1-Z/T.height,X=1-_.deltaY*0.002,l=L.MARGIN,q0=z<l.left,J0=Z>T.height-l.bottom,n,i;if(q0)n=!1,i=!0;else if(J0)n=!0,i=!1;else n=F.zoomMode==="both"||F.zoomMode==="x-only",i=F.zoomMode==="both"||F.zoomMode==="y-only";if(n){let R0=F.view.panX+Y/F.view.zoomX;F.view.zoomX=Math.max(L.MIN_ZOOM,Math.min(L.MAX_ZOOM,F.view.zoomX*X)),F.view.panX=R0-Y/F.view.zoomX}if(i){let R0=F.view.panY+C/F.view.zoomY;F.view.zoomY=Math.max(L.MIN_ZOOM,Math.min(L.MAX_ZOOM,F.view.zoomY*X)),F.view.panY=R0-C/F.view.zoomY}if(n||i)D()},{passive:!1,signal:N.signal})},uninstall(F){let q=J.get(F);if(q){if(F.momentum)cancelAnimationFrame(F.momentum),F.momentum=null;q.el.style.touchAction=q.originalTouchAction,q.el.style.userSelect=q.originalUserSelect,q.el.style.webkitUserSelect=q.originalWebkitUserSelect,q.abort.abort(),J.delete(F)}}}}var j0=new WeakMap,b0=($,G,J,F,q,j,E,K)=>{$.beginPath(),$.roundRect(G,J,F,q,j),$.fillStyle=E,$.fill(),$.strokeStyle=K,$.lineWidth=1.5,$.stroke()},W0={name:"hover",install($,G){let J=L.getInstance(),F=new AbortController,q={hoverResult:null,pillX:0,pillY:0,pillTargetX:0,pillTargetY:0,pillAnimRef:null,abort:F};j0.set($,q);let j=(K)=>{if($.config.onHover)$.config.onHover(K);if(!($.config.showTooltip??!1))return;if(q.hoverResult=K,J.drawChart($),K&&!q.pillAnimRef){let V=performance.now(),N=(O)=>{if(!q.hoverResult)return q.pillAnimRef=null;let Q=1-Math.pow(0.5,(O-V)/($.config.pillDecayMs??60));V=O,q.pillX+=(q.pillTargetX-q.pillX)*Q,q.pillY+=(q.pillTargetY-q.pillY)*Q,J.drawChart($),q.pillAnimRef=requestAnimationFrame(N)};q.pillAnimRef=requestAnimationFrame(N)}},E=(K,V)=>{if($.dragging)return;let N=G.getBoundingClientRect();j($.findNearestPoint(K-N.left,V-N.top,N.width,N.height))};G.addEventListener("mousemove",(K)=>E(K.clientX,K.clientY),{signal:F.signal}),G.addEventListener("touchmove",(K)=>{if(K.touches.length===1)E(K.touches[0].clientX,K.touches[0].clientY)},{signal:F.signal,passive:!0}),["mouseleave","pointerdown","touchend","touchcancel"].forEach((K)=>G.addEventListener(K,()=>j(null),{signal:F.signal}))},afterDraw($,G){let J=j0.get(G);if(!J?.hoverResult||!G.config.showTooltip)return;let{hoverResult:F}=J,q=G.width,j=G.height,E=L.MARGIN,K=L.getInstance().isDark,{formatX:V=String,formatY:N=String,fontFamily:O=L.DEFAULT_FONT}=G.config,Q=(G.bounds.maxX-G.bounds.minX)/G.view.zoomX,R=(G.bounds.maxY-G.bounds.minY)/G.view.zoomY,B=(F.x-(G.bounds.minX+G.view.panX*(G.bounds.maxX-G.bounds.minX)))/Q*q,H=j*(1-(F.y-(G.bounds.minY+G.view.panY*(G.bounds.maxY-G.bounds.minY)))/R),A=G.series[F.seriesIndex]||G.series[0],M=`${Math.round(A.color.r*255)},${Math.round(A.color.g*255)},${Math.round(A.color.b*255)}`,W=`rgb(${M})`,f=K?`oklch(from ${W} calc(l + 0.1) c h)`:W;$.save(),$.setLineDash([4,3]),$.strokeStyle=`rgba(${M},0.4)`,$.stroke(new Path2D(`M${B} 0V${j-E.bottom}M${E.left} ${H}H${q}`)),$.restore(),$.beginPath(),$.arc(B,H,4.5,0,Math.PI*2),$.fillStyle=W,$.fill(),$.strokeStyle=K?"rgba(0,0,0,0.6)":"rgba(255,255,255,0.9)",$.stroke();let S=G.series.map((U)=>{let w=0,y=U.rawX.length-1;while(w<=y){let I=w+y>>1;if(Math.abs(U.rawX[I]-F.x)<0.0001)return{label:U.label,val:N(U.rawY[I]),rawVal:U.rawY[I],col:`rgb(${Math.round(U.color.r*255)},${Math.round(U.color.g*255)},${Math.round(U.color.b*255)})`};U.rawX[I]<F.x?w=I+1:y=I-1}return null}).filter(Boolean);S.sort((U,w)=>Math.abs(w.rawVal)-Math.abs(U.rawVal));let g=S.length,k=S.slice(0,5),u=g-k.length;if(J.pillTargetX=B,J.pillTargetY=H,!J.pillAnimRef)J.pillX=B,J.pillY=H;let d=(U,w,y,I)=>{$.font=`600 10px ${O}`;let h=$.measureText(y).width,D=h+12,$0=18,r=I?U-D/2:U-D,_=I?w:w-$0/2;$.save();let T=I?Math.atan((J.pillTargetX-J.pillX)/80)*0.2:Math.atan((J.pillTargetY-J.pillY)/80)*0.2;$.translate(U,w),$.rotate(T);let z=I?-D/2:-D,Z=I?0:-$0/2;$.beginPath(),$.roundRect(z,Z,D,$0,4),$.fillStyle=K?"rgba(0,0,0,0.75)":"rgba(255,255,255,0.75)",$.fill(),$.fillStyle=`rgba(${M},0.2)`,$.fill(),$.strokeStyle=f,$.lineWidth=1.5,$.stroke(),$.fillStyle=f,$.textAlign="center",$.textBaseline="middle",$.fillText(y,z+D/2,Z+$0/2),$.restore()};d(Math.max(E.left,Math.min(q-E.right,J.pillX)),j-E.bottom+4,V(F.x),!0),d(Math.max(E.left,E.left),Math.max(9,Math.min(j-E.bottom-9,J.pillY)),N(F.y),!1);let x=Math.max(...k.map((U)=>$.measureText(U.label+U.val).width))+40,m=30+k.length*18+(u>0?18:0),o=F.screenX+14,b=F.screenY-m-6;if(o+x>q)o=F.screenX-x-14;if(b=Math.max(4,Math.min(j-m-4,F.screenY-m-6)),b0($,o,b,x,m,6,K?"rgba(28,28,30,0.95)":"rgba(255,255,255,0.96)","rgba(0,0,0,0.08)"),$.textAlign="left",$.textBaseline="middle",$.fillStyle=K?"#888":"#999",$.fillText(V(F.x),o+10,b+15),k.forEach((U,w)=>{let y=b+35+w*18;$.fillStyle=U.col,$.beginPath(),$.roundRect(o+10,y-4,8,8,2),$.fill(),$.fillStyle=K?"#eee":"#1a1a1a",$.fillText(`${U.label}: ${U.val}`,o+24,y)}),u>0){let U=b+35+k.length*18;$.fillStyle=K?"#666":"#aaa",$.fillText(`+${u} more`,o+10,U)}},uninstall($){let G=j0.get($);if(G?.pillAnimRef)cancelAnimationFrame(G.pillAnimRef);G?.abort.abort(),j0.delete($)}};Q0(z0);Q0(Z0());Q0(W0);var P,F0=document.documentElement.classList.contains("dark"),k0=1,_0=null,U0=!1,M0,f0,w0,v=[],e=[],t=[],a=[],B0=null,L0=null,O0=null;function X0($,G,J){let F=(1-Math.abs(2*J-1))*G,q=F*(1-Math.abs($/60%2-1)),j=J-F/2,E=0,K=0,V=0;if($<60)E=F,K=q;else if($<120)E=q,K=F;else if($<180)K=F,V=q;else if($<240)K=q,V=F;else if($<300)E=q,V=F;else E=F,V=q;return{r:E+j,g:K+j,b:V+j}}function K0(){return X0(Math.random()*360,0.65+Math.random()*0.2,0.5+Math.random()*0.1)}var D0=new Date("2026-02-03");function s($){if($>=1000)return"$"+($/1000).toFixed(1)+"k";if($>=100)return"$"+$.toFixed(0);if($>=10)return"$"+$.toFixed(1);return"$"+$.toFixed(2)}function N0($){let G=D0.getTime()-Math.round($)*60000,J=new Date(G),q=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"][J.getMonth()],j=J.getDate(),E=J.getFullYear();return`${q} ${j}, ${E}`}function V0($){if(Math.abs($)>=1000)return($/1000).toFixed(1)+"k";if(Math.abs($)>=100)return $.toFixed(0);if(Math.abs($)>=10)return $.toFixed(1);return $.toFixed(2)}function c($){return Math.round($).toString()}function p($,G){let J=new Array($),F=new Array($);if(G==="stock")for(let E=0;E<$;E++)J[E]=$-1-E;else for(let E=0;E<$;E++)J[E]=E;let j=2*Math.PI;switch(G){case"stock":{let K=Math.LN2/5258880,V=-K*3,N=0.0005,O=0.0009000000000000001,Q=$/5258880,R=Math.max(1,Math.round(Q*(0.8+Math.random()*0.4))),B=[];for(let f=0;f<R;f++){let S=Math.floor(Math.random()*$*0.9),g=Math.floor((180+Math.random()*360)*1440);B.push({s:S,e:S+g})}B.sort((f,S)=>f.s-S.s);let H=Math.log(10+Math.random()*20),A=0,M=0,W=!1;for(let f=0;f<$;f++){while(A<B.length&&f>=B[A].e)A++;let S=A<B.length&&f>=B[A].s&&f<B[A].e,g=S?V:K,k=S?0.0009000000000000001:0.0005,u;if(W)u=M,W=!1;else{let d=Math.random()||0.0000000001,x=Math.sqrt(-2*Math.log(d)),m=j*Math.random();u=x*Math.cos(m),M=x*Math.sin(m),W=!0}H+=g+k*u,F[f]=Math.exp(H)}break}case"trending":{let E=Math.log(20+Math.random()*20),K=Math.LN2/$,V=0.015,N=0,O=!1;for(let Q=0;Q<$;Q++){let R;if(O)R=N,O=!1;else{let B=Math.random()||0.0000000001,H=Math.sqrt(-2*Math.log(B)),A=j*Math.random();R=H*Math.cos(A),N=H*Math.sin(A),O=!0}E+=K+V*R,F[Q]=Math.exp(E)}break}case"declining":{let E=Math.log(60+Math.random()*40),K=-Math.LN2/$,V=0.015,N=0,O=!1;for(let Q=0;Q<$;Q++){let R;if(O)R=N,O=!1;else{let B=Math.random()||0.0000000001,H=Math.sqrt(-2*Math.log(B)),A=j*Math.random();R=H*Math.cos(A),N=H*Math.sin(A),O=!0}E+=K+V*R,F[Q]=Math.exp(E)}break}case"spikey":{let E=20+Math.random()*30,K=3+Math.floor(Math.random()*5),V=new Set;while(V.size<Math.min(K,$))V.add(Math.floor(Math.random()*$));let N=E*1.2,O=E*5;for(let Q=0;Q<$;Q++)if(V.has(Q))F[Q]=Math.random()<0.5?-O:O;else F[Q]=(Math.random()-0.5)*N;break}case"cyclic":{let E=Date.now()%1e5/1e5*j,K=30+Math.random()*20,V=50+Math.random()*20,N=2+Math.random()*4,O=j*N/$,Q=K*0.25;for(let R=0;R<$;R++){let B=R*O+E;F[R]=V+Math.sin(B)*K+Math.sin(B*2.7+1.3)*Q+(Math.random()-0.5)*8}break}}return{x:J,y:F}}async function u0(){if(P=L.getInstance(),!await P.init()){alert("WebGPU not available. Please use a supported browser.");return}o0(),m0(),v0(),p0(),g0(),x0(),d0()}function m0(){let $=p(25,"trending");P.create({type:"bar",container:document.getElementById("basic-bar"),series:[{label:"Revenue",color:{r:0.6,g:0.4,b:0.9},x:$.x,y:$.y}],formatX:c,formatY:s,showTooltip:!0});let G=p(1000,"trending"),J=G.x.map((q,j)=>999-j);P.create({type:"line",container:document.getElementById("basic-line"),series:[{label:"Stock Price",color:{r:0.3,g:0.6,b:1},x:J,y:G.y}],formatX:N0,formatY:s,showTooltip:!0});let F=p(5000,"cyclic");P.create({type:"scatter",container:document.getElementById("basic-scatter"),series:[{label:"Cyclic Data",color:{r:1,g:0.4,b:0.4},x:F.x,y:F.y}],formatX:c,formatY:V0,showTooltip:!0})}function v0(){let $=[],G=p(25,"trending"),J=[1,0.7,1.3];for(let j=0;j<3;j++){let E=p(25,"trending"),K=E.y.map((V)=>V*J[j]);$.push({label:`Series ${j+1}`,color:K0(),x:E.x,y:K})}P.create({type:"bar",container:document.getElementById("series-bar"),series:$,formatX:c,formatY:s,showTooltip:!0});let F=[];for(let j=0;j<3;j++){let E=p(1000,"trending"),K=E.x.map((V,N)=>999-N);F.push({label:`Series ${j+1}`,color:K0(),x:K,y:E.y})}P.create({type:"line",container:document.getElementById("series-line"),series:F,formatX:N0,formatY:s,showTooltip:!0});let q=[];for(let j=0;j<3;j++){let E=p(5000,"cyclic");q.push({label:`Series ${j+1}`,color:K0(),x:E.x,y:E.y})}P.create({type:"scatter",container:document.getElementById("series-scatter"),series:q,formatX:c,formatY:V0,showTooltip:!0})}function p0(){let $=p(1e5,"spikey");P.create({type:"line",container:document.getElementById("spikes-line"),series:[{label:"Volatile Data",color:{r:1,g:0.5,b:0.2},x:$.x,y:$.y}],formatX:c,formatY:V0,showTooltip:!0})}function g0(){let $=p(100,"trending"),G=p(100,"trending"),J=p(100,"trending");v=Array.from({length:100},(j,E)=>E),e=[...$.y],t=[...G.y],a=[...J.y],M0=P.create({type:"line",container:document.getElementById("live-line"),series:[{label:"Live Data",color:{r:0.2,g:0.8,b:0.4},x:[...v],y:[...e]}],formatX:c,formatY:s,showTooltip:!0}),f0=P.create({type:"scatter",container:document.getElementById("live-scatter"),series:[{label:"Live Data",color:{r:0.9,g:0.3,b:0.7},x:[...v],y:[...t]}],formatX:c,formatY:s,showTooltip:!0}),w0=P.create({type:"line",container:document.getElementById("live-line2"),series:[{label:"Live Data",color:{r:0.4,g:0.5,b:1},x:[...v],y:[...a]}],formatX:c,formatY:s,showTooltip:!0});let F=document.querySelectorAll(".speed-btn");F.forEach((j)=>{j.addEventListener("click",()=>{F.forEach((E)=>E.classList.remove("active")),j.classList.add("active"),k0=parseInt(j.dataset.speed),T0()})});let q=document.getElementById("accumulate-toggle");q.addEventListener("change",()=>{U0=q.checked}),T0()}function T0(){if(_0!==null)clearInterval(_0);let $=1000/k0;_0=window.setInterval(()=>{let G=v.length>0?v[v.length-1]+1:0,J=e.length>0?e[e.length-1]:50,F=t.length>0?t[t.length-1]:50,q=a.length>0?a[a.length-1]:50;if(v.push(G),e.push(J+(Math.random()-0.5)*5),t.push(F+(Math.random()-0.5)*8),a.push(q+(Math.random()-0.5)*6),!U0&&v.length>500)v.shift(),e.shift(),t.shift(),a.shift();P.updateSeries(M0,[{label:"Live Data",color:{r:0.2,g:0.8,b:0.4},x:[...v],y:[...e]}]),P.updateSeries(f0,[{label:"Live Data",color:{r:0.9,g:0.3,b:0.7},x:[...v],y:[...t]}]),P.updateSeries(w0,[{label:"Live Data",color:{r:0.4,g:0.5,b:1},x:[...v],y:[...a]}]);let j=U0?"Accumulate":"Ring Buffer";document.getElementById("live-stats").textContent=`Points: ${v.length} (${j})`},$)}function x0(){let $=document.getElementById("bigdata-generate"),G=document.getElementById("bigdata-count"),J=document.getElementById("bigdata-stats");$.addEventListener("click",()=>{let F=parseInt(G.value)||1e6;$.setAttribute("disabled","true"),J.textContent="Generating...",setTimeout(()=>{let q=performance.now();if(B0)P.destroy(B0);if(L0)P.destroy(L0);let j=p(F,"stock"),E=p(F,"cyclic");B0=P.create({type:"line",container:document.getElementById("bigdata-line"),series:[{label:"Big Data",color:{r:0.3,g:0.7,b:0.9},x:j.x,y:j.y}],formatX:N0,formatY:s,showTooltip:!0}),L0=P.create({type:"scatter",container:document.getElementById("bigdata-scatter"),series:[{label:"Big Data",color:{r:0.9,g:0.5,b:0.3},x:E.x,y:E.y}],formatX:c,formatY:V0,showTooltip:!0});let K=performance.now()-q,V=(F/1e6).toFixed(1)+"M";document.getElementById("bigdata-line-info").textContent=V,document.getElementById("bigdata-scatter-info").textContent=V,J.textContent=`Generated in ${K.toFixed(0)}ms`,$.removeAttribute("disabled")},50)})}function d0(){let $=document.getElementById("bigseries-generate"),G=document.getElementById("bigseries-series"),J=document.getElementById("bigseries-points"),F=document.getElementById("bigseries-stats");$.addEventListener("click",()=>{let q=parseInt(G.value)||1000,j=parseInt(J.value)||1000;$.setAttribute("disabled","true"),F.textContent="Generating...",setTimeout(()=>{let E=performance.now();if(O0)P.destroy(O0);let K=[];for(let Q=0;Q<q;Q++){let R=p(j,"trending"),B=R.x.map((H,A)=>j-1-A);K.push({label:`S${Q+1}`,color:K0(),x:B,y:R.y})}O0=P.create({type:"line",container:document.getElementById("bigseries-line"),series:K,formatX:N0,formatY:s,showTooltip:!0});let V=performance.now()-E,N=q*j,O=N>=1e6?(N/1e6).toFixed(1)+"M":(N/1000).toFixed(0)+"k";document.getElementById("bigseries-info").textContent=`${q} series Ã— ${j} pts = ${O} total`,F.textContent=`Generated in ${V.toFixed(0)}ms`,$.removeAttribute("disabled")},50)})}function o0(){let $=document.getElementById("theme-btn"),G=document.getElementById("theme-icon-sun"),J=document.getElementById("theme-icon-moon"),F=()=>{G.style.display=F0?"none":"block",J.style.display=F0?"block":"none"};F(),$.addEventListener("click",()=>{F0=!F0,document.documentElement.classList.toggle("dark",F0),localStorage.setItem("theme",F0?"dark":"light"),P.setTheme(F0),F()})}u0();
