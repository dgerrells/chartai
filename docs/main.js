var w0=Object.create;var{getPrototypeOf:I0,defineProperty:U0,getOwnPropertyNames:y0}=Object;var C0=Object.prototype.hasOwnProperty;var S0=($,G,q)=>{q=$!=null?w0(I0($)):{};let F=G||!$||!$.__esModule?U0(q,"default",{value:$,enumerable:!0}):q;for(let J of y0($))if(!C0.call(F,J))U0(F,J,{get:()=>$[J],enumerable:!0});return F};var Y0=(($)=>typeof require!=="undefined"?require:typeof Proxy!=="undefined"?new Proxy($,{get:(G,q)=>(typeof require!=="undefined"?require:G)[q]}):$)(function($){if(typeof require!=="undefined")return require.apply(this,arguments);throw Error('Dynamic require of "'+$+'" is not supported')});var F0=[];function J0($){if(!F0.some((G)=>G.name===$.name))F0.push($)}class L{static instance=null;static MARGIN={left:55,right:10,top:8,bottom:45};static HOVER_MAX_DISTANCE_PX=50;static MIN_ZOOM=0.1;static MAX_ZOOM=1e7;static DEFAULT_LABEL_SIZE=12;static DEFAULT_FONT='-apple-system, BlinkMacSystemFont, "Segoe UI", system-ui, sans-serif';static resizeCanvas($,G,q){let F=devicePixelRatio||1;if($.width=Math.round(G*F),$.height=Math.round(q*F),$ instanceof HTMLCanvasElement)$.style.width=`${G}px`,$.style.height=`${q}px`}worker=null;charts=new Map;chartIdCounter=0;_syncViews=!1;_isDark=!1;statsCallbacks=[];currentStats={fps:0,renderMs:0,total:0,active:0};visibilityObserver;resizeObserver;constructor(){this._isDark=document.documentElement.classList.contains("dark"),this.visibilityObserver=new IntersectionObserver(($)=>{for(let G of $){let q=G.target.dataset.chartId;if(q){let F=this.charts.get(q);if(F){if(F.visible=G.isIntersecting,this.worker?.postMessage({type:"set-visibility",id:q,visible:G.isIntersecting}),G.isIntersecting)this.drawChart(F)}}}},{threshold:0.01}),this.resizeObserver=new ResizeObserver(($)=>{for(let G of $){let q=G.target.dataset.chartId;if(!q)continue;let F=this.charts.get(q);if(!F)continue;let{width:J,height:j}=G.contentRect;if(J<=0||j<=0)continue;F.width=J,F.height=j;let E=devicePixelRatio||1;this.worker?.postMessage({type:"resize",id:q,width:Math.round(J*E),height:Math.round(j*E)}),L.resizeCanvas(F.backCanvas,J,j),L.resizeCanvas(F.axisCanvas,J,j),this.drawChart(F)}})}static getInstance(){if(!L.instance)L.instance=new L;return L.instance}get isDark(){return this._isDark}get syncViews(){return this._syncViews}async init(){if(this.worker)return!0;return new Promise(($)=>{import("./worker-inline.js").then(({WORKER_CODE:G})=>{let q=new Blob([G],{type:"application/javascript"}),F=URL.createObjectURL(q);this.worker=new Worker(F,{type:"module"}),this.setupWorkerHandlers($)}).catch(()=>{let G=new URL("./gpu-worker.js",import.meta.url);this.worker=new Worker(G,{type:"module"}),this.setupWorkerHandlers($)})})}setupWorkerHandlers($){if(!this.worker)return;this.worker.onmessage=(G)=>{let{type:q,...F}=G.data;switch(q){case"gpu-ready":$(!0);break;case"error":console.error("ChartManager GPU Error:",F.message),$(!1);break;case"stats":this.currentStats={fps:F.fps,renderMs:F.renderMs,total:F.totalCharts,active:F.activeCharts};for(let J of this.statsCallbacks)J(this.currentStats);break;case"bounds-update":{let J=this.charts.get(F.id);if(J)J.bounds={minX:F.minX,maxX:F.maxX,minY:F.minY,maxY:F.maxY},this.drawChart(J);break}default:break}},this.worker.onerror=(G)=>{console.error("ChartManager Worker Error:",G),$(!1)},this.worker.postMessage({type:"init",isDark:this._isDark})}create($){if(!this.worker)throw new Error("ChartManager not initialized. Call init() first.");let G=`chart-${++this.chartIdCounter}`,q=document.createElement("div");q.dataset.chartId=G,q.style.cssText="width: 100%; height: 100%; position: relative;";let F=document.createElement("div");F.dataset.chartId=G,F.style.cssText="width: 100%; height: 100%; position: relative;";let J=document.createElement("canvas");J.style.cssText="position: absolute; inset: 0; width: 100%; height: 100%; pointer-events: none;";let j=document.createElement("canvas");j.style.cssText="position: absolute; inset: 0; width: 100%; height: 100%; pointer-events: auto; z-index: 1;";let E=document.createElement("canvas");E.style.cssText="position: absolute; inset: 0; width: 100%; height: 100%; pointer-events: none; z-index: 2;",F.appendChild(J),F.appendChild(j),F.appendChild(E),q.appendChild(F),$.container.appendChild(q);let K;try{K=j.transferControlToOffscreen()}catch(B){throw console.error(`ChartManager: Failed to create offscreen canvas for ${G}:`,B),new Error(`Failed to create chart ${G}: ${B}`)}let V=F.getBoundingClientRect(),N=V.width||400,O=V.height||200;if(L.resizeCanvas(K,N,O),L.resizeCanvas(J,N,O),L.resizeCanvas(E,N,O),$.bgColor){let[B,H,A]=$.bgColor;F.style.background=`rgb(${Math.round(B*255)},${Math.round(H*255)},${Math.round(A*255)})`}let Q={id:G,config:$,el:q,backCanvas:J,axisCanvas:E,width:N,height:O,series:[],bounds:{minX:0,maxX:1,minY:0,maxY:1},view:{panX:0,panY:0,zoomX:1,zoomY:1},zoomMode:$.zoomMode||"both",visible:!0,dragging:!1,bgColor:$.bgColor,textColor:$.textColor,gridColor:$.gridColor,fontFamily:$.fontFamily,momentum:null,findNearestPoint(B,H,A,M){if(this.series.length===0)return null;let W=B/A,f=H/M,S=this.bounds.maxX-this.bounds.minX,d=this.bounds.maxY-this.bounds.minY,k=S/this.view.zoomX,m=d/this.view.zoomY,o=this.bounds.minX+this.view.panX*S,v=this.bounds.minY+this.view.panY*d,D=o+W*k,l=v+(1-f)*m,Y=-1,U=-1,P=1/0,y=1/0;for(let s=0;s<this.series.length;s++){let _=this.series[s],T=_.rawX.length;if(T===0)continue;let Z=0,z=T-1;while(Z<z){let p=Z+z>>1;if(_.rawX[p]<D)Z=p+1;else z=p}let b=Z;if(Z>0){let p=Math.abs(_.rawX[Z]-D);if(Math.abs(_.rawX[Z-1]-D)<p)b=Z-1}let C=Math.abs(_.rawX[b]-D),X=Math.abs(_.rawY[b]-l);if(C<P||C===P&&X<y)P=C,y=X,Y=s,U=b}if(Y===-1)return null;let w=this.series[Y],u=(w.rawX[U]-o)/k*A;if(Math.abs(u-B)>L.HOVER_MAX_DISTANCE_PX)return null;return{x:w.rawX[U],y:w.rawY[U],index:U,screenX:B,screenY:H,seriesIndex:Y,seriesLabel:w.label}}};this.charts.set(G,Q);let R=$.type==="bar"?"box":$.type;this.worker.postMessage({type:"register-chart",id:G,canvas:K,chartType:R,pointSize:$.pointSize??3,maxSamplesPerPixel:$.maxSamplesPerPixel??1e4,bgColor:$.bgColor??null},[K]),this.visibilityObserver.observe(q),this.resizeObserver.observe(F);for(let B of F0)B.install?.(Q,F);return this.updateSeries(G,$.series),G}destroy($){let G=this.charts.get($);if(!G)return;for(let F of F0)F.uninstall?.(G);if(G.momentum)cancelAnimationFrame(G.momentum);this.visibilityObserver.unobserve(G.el);let q=G.el.querySelector(".gpu-chart-canvas-wrap");if(q)this.resizeObserver.unobserve(q);G.el.remove(),this.worker?.postMessage({type:"unregister-chart",id:$}),this.charts.delete($)}updateSeries($,G){let q=this.charts.get($);if(!q||!this.worker)return;if(G.length===0)return;q.series=G.map((Q)=>{let R=Q.x.length;if(R===0)return{label:Q.label,color:Q.color,rawX:[],rawY:[]};let B=Array.from({length:R},(H,A)=>A);return B.sort((H,A)=>Q.x[H]-Q.x[A]),{label:Q.label,color:Q.color,rawX:B.map((H)=>Q.x[H]),rawY:B.map((H)=>Q.y[H])}});let F=1/0,J=-1/0,j=1/0,E=-1/0;for(let Q of q.series)for(let R=0;R<Q.rawX.length;R++){if(Q.rawX[R]<F)F=Q.rawX[R];if(Q.rawX[R]>J)J=Q.rawX[R];if(Q.rawY[R]<j)j=Q.rawY[R];if(Q.rawY[R]>E)E=Q.rawY[R]}let K=(J-F)*0.05||1,V=(E-j)*0.1||1;F-=K,J+=K,j-=V,E+=V;let N=q.config.defaultBounds;if(N){if(N.minX!==void 0)F=N.minX;if(N.maxX!==void 0)J=N.maxX;if(N.minY!==void 0)j=N.minY;if(N.maxY!==void 0)E=N.maxY}q.bounds={minX:F,maxX:J,minY:j,maxY:E};let O=q.series.map((Q)=>({label:Q.label,colorR:Q.color.r,colorG:Q.color.g,colorB:Q.color.b,dataX:new Float32Array(Q.rawX),dataY:new Float32Array(Q.rawY)}));this.worker.postMessage({type:"update-series",id:$,series:O,bounds:q.bounds},O.flatMap((Q)=>[Q.dataX.buffer,Q.dataY.buffer])),this.sendViewTransform(q),this.drawChart(q)}setPointSize($,G){if(!this.charts.get($))return;this.worker?.postMessage({type:"set-point-size",id:$,pointSize:Math.max(1,Math.min(8,Math.round(G)))})}setMaxSamplesPerPixel($,G){if(!this.charts.get($))return;this.worker?.postMessage({type:"set-max-samples",id:$,maxSamplesPerPixel:Math.max(0,G|0)})}setStyle($,G){let q=this.charts.get($);if(!q)return;if(G.bgColor!==void 0)q.bgColor=G.bgColor;if(G.textColor!==void 0)q.textColor=G.textColor;if(G.gridColor!==void 0)q.gridColor=G.gridColor;if(G.fontFamily!==void 0)q.fontFamily=G.fontFamily;if(G.bgColor!==void 0){let F=q.el.querySelector(".gpu-chart-canvas-wrap");if(F){let[J,j,E]=G.bgColor;F.style.background=`rgb(${Math.round(J*255)},${Math.round(j*255)},${Math.round(E*255)})`}this.worker?.postMessage({type:"set-style",id:$,bgColor:G.bgColor})}this.drawChart(q)}setZoomMode($,G){let q=this.charts.get($);if(q)q.zoomMode=G}getChartCount(){return this.charts.size}getZoomMode($){return this.charts.get($)?.zoomMode||"both"}setSyncViews($){this._syncViews=$}setTheme($){this._isDark=$,this.worker?.postMessage({type:"theme",isDark:$});for(let G of this.charts.values())this.drawChart(G)}onStats($){return this.statsCallbacks.push($),()=>{let G=this.statsCallbacks.indexOf($);if(G>=0)this.statsCallbacks.splice(G,1)}}getStats(){return{...this.currentStats}}resetView($){let G=this.charts.get($);if(!G)return;if(G.momentum)cancelAnimationFrame(G.momentum),G.momentum=null;let q=G.view.panX,F=G.view.panY,J=G.view.zoomX,j=G.view.zoomY,E=performance.now(),K=()=>{let V=Math.min(1,(performance.now()-E)/300),N=1-Math.pow(1-V,3);if(G.view.panX=q*(1-N),G.view.panY=F*(1-N),G.view.zoomX=J+(1-J)*N,G.view.zoomY=j+(1-j)*N,this.sendViewTransform(G),this.drawChart(G),this._syncViews)this.syncAllViews(G);if(V<1)requestAnimationFrame(K)};requestAnimationFrame(K)}sendViewTransform($){this.worker?.postMessage({type:"view-transform",id:$.id,panX:$.view.panX,panY:$.view.panY,zoomX:$.view.zoomX,zoomY:$.view.zoomY})}syncAllViews($){let G=[];for(let q of this.charts.values())if(q.id!==$.id)q.view={...$.view},G.push({id:q.id}),this.drawChart(q);if(G.length>0)this.worker?.postMessage({type:"batch-view-transform",panX:$.view.panX,panY:$.view.panY,zoomX:$.view.zoomX,zoomY:$.view.zoomY,transforms:G})}drawChart($){if(!$.visible)return;let G=devicePixelRatio||1,q=$.backCanvas.getContext("2d");if(q){q.clearRect(0,0,$.backCanvas.width,$.backCanvas.height),q.save(),q.scale(G,G);for(let J of F0)J.beforeDraw?.(q,$);q.restore()}let F=$.axisCanvas.getContext("2d");if(F){F.clearRect(0,0,$.axisCanvas.width,$.axisCanvas.height),F.save(),F.scale(G,G);for(let J of F0)J.afterDraw?.(F,$);F.restore()}}}var Q0=($,G,q)=>{let F=G-$;if(F<=0)return[$];let J=F/q,j=10**Math.floor(Math.log10(J)),E=J/j,K=j*(E<=1.5?1:E<=3?2:E<=7?5:10),V=[];for(let N=Math.ceil($/K)*K;N<=G;N+=K)V.push(N);return V},A0=($)=>{let G=L.getInstance(),q=$.width,F=$.height,J=L.MARGIN,{bounds:j,view:E}=$,K=j.maxX-j.minX,V=j.maxY-j.minY,N=K/E.zoomX,O=V/E.zoomY,Q=j.minX+E.panX*K,R=j.minY+E.panY*V,B=$.bgColor??(G.isDark?[0.11,0.11,0.12]:[0.98,0.98,0.98]);return{w:q,h:F,m:J,rx:N,ry:O,mx:Q,my:R,bg:`${Math.round(B[0]*255)},${Math.round(B[1]*255)},${Math.round(B[2]*255)}`,font:$.fontFamily??L.DEFAULT_FONT,text:$.textColor??(G.isDark?"#c0c0c0":"#333333"),grid:$.gridColor??(G.isDark?"rgba(255,255,255,0.06)":"rgba(0,0,0,0.06)")}},H0={name:"labels",beforeDraw($,G){let{w:q,h:F,m:J,rx:j,ry:E,mx:K,my:V,grid:N}=A0(G);$.strokeStyle=N,$.lineWidth=1,$.beginPath(),Q0(V,V+E,7).forEach((O)=>{let Q=F*(1-(O-V)/E);if(Q>5&&Q<F-J.bottom-5)$.moveTo(J.left,Q),$.lineTo(q,Q)}),Q0(K,K+j,8).forEach((O)=>{let Q=q*((O-K)/j);if(Q>J.left&&Q<q)$.moveTo(Q,0),$.lineTo(Q,F-J.bottom)}),$.stroke()},afterDraw($,G){let{w:q,h:F,m:J,rx:j,ry:E,mx:K,my:V,bg:N,font:O,text:Q}=A0(G),{formatX:R=String,formatY:B=String,labelSize:H=L.DEFAULT_LABEL_SIZE}=G.config,A=(M,W,f,S,d)=>{let k=M==="left"?$.createLinearGradient(W,0,W+S,0):$.createLinearGradient(0,f,0,f+d),m=M==="left"?[1,0.7,0.2,0.05,0]:[0,0.05,0.2,0.7,1];[0,0.35,0.55,0.7,1].forEach((o,v)=>k.addColorStop(o,`rgba(${N},${m[v]})`)),$.fillStyle=k,$.fillRect(W,f,S,d)};A("left",0,0,J.left+20,F),A("bottom",0,F-J.bottom-20,q,J.bottom+20),$.font=`${H}px ${O}`,$.fillStyle=Q,$.textAlign="right",$.textBaseline="middle",Q0(V,V+E,7).forEach((M)=>{let W=F*(1-(M-V)/E);if(W>5&&W<F-J.bottom-5)$.fillText(B(M),J.left-5,W)}),$.textAlign="right",$.textBaseline="top",Q0(K,K+j,8).forEach((M)=>{let W=q*((M-K)/j);if(W<J.left-10||W>q+30)return;$.save(),$.translate(W,F-J.bottom+5),$.rotate(-Math.PI/14),$.fillText(R(M),0,0),$.restore()})}};function z0($={}){let G=$.momentumDecay??0.9,q=new WeakMap;return{name:"zoom",install(F,J){let j=J.style.touchAction,E=J.style.userSelect,K=J.style.webkitUserSelect;J.style.touchAction="none",J.style.userSelect="none",J.style.webkitUserSelect="none";let V=L.getInstance(),N=new AbortController,O={lastX:0,lastY:0,velX:0,velY:0,abort:N,originalTouchAction:j,originalUserSelect:E,originalWebkitUserSelect:K,el:J};q.set(F,O);let Q=[],R="none",B=0,H=0,A=0,M=0,W=0,f=10,S=10,d=500,k=null,m=0,o=1,v=1,D=0.5,l=0.5,Y=0,U=0,P=0,y=null,w=0,n=1,u=()=>{if(V.sendViewTransform(F),V.drawChart(F),V.syncViews)V.syncAllViews(F)},t=()=>{if(F.momentum)cancelAnimationFrame(F.momentum);let _=()=>{if(Y*=G,U*=G,Math.abs(Y)>0.00005||Math.abs(U)>0.00005){if(F.zoomMode!=="none"&&(F.zoomMode==="both"||F.zoomMode==="x-only"))F.view.panX-=Y/F.view.zoomX;if(F.zoomMode!=="none"&&(F.zoomMode==="both"||F.zoomMode==="y-only"))F.view.panY+=U/F.view.zoomY;u(),F.momentum=requestAnimationFrame(_)}else F.momentum=null};F.momentum=requestAnimationFrame(_)};J.addEventListener("pointerdown",(_)=>{if(F.momentum)cancelAnimationFrame(F.momentum),F.momentum=null;if(Q.push(_),J.setPointerCapture(_.pointerId),Q.length===1)if(R="detecting",B=_.clientX,H=_.clientY,A=_.clientX,M=_.clientY,Y=U=0,W=performance.now(),y=null,_.pointerType==="touch")k=window.setTimeout(()=>{if(R==="detecting")R="press",F.dragging=!1},d);else{let T=J.getBoundingClientRect(),Z=_.clientX-T.left,z=_.clientY-T.top,b=L.MARGIN,C=Z<b.left,X=z>T.height-b.bottom;if(C&&!X)y="y",w=_.clientY,n=F.view.zoomY,F.dragging=!0;else if(X&&!C)y="x",w=_.clientX,n=F.view.zoomX,F.dragging=!0;else F.dragging=!0}else if(Q.length===2){if(k)clearTimeout(k),k=null;if(R="pinch",F.dragging=!1,_.pointerType==="touch")_.preventDefault();let T=J.getBoundingClientRect(),Z=Q[1].clientX-Q[0].clientX,z=Q[1].clientY-Q[0].clientY;m=Math.hypot(Z,z),o=F.view.zoomX,v=F.view.zoomY,D=((Q[0].clientX+Q[1].clientX)/2-T.left)/T.width,l=1-((Q[0].clientY+Q[1].clientY)/2-T.top)/T.height}},{passive:!1,signal:N.signal}),J.addEventListener("pointermove",(_)=>{let T=Q.findIndex((Z)=>Z.pointerId===_.pointerId);if(T>=0)Q[T]=_;if(Q.length===1){let Z=Math.hypot(_.clientX-B,_.clientY-H);if(R==="detecting"&&Z>f){if(R="pan",F.dragging=!0,k)clearTimeout(k),k=null}if(R==="press")return;if(y&&_.pointerType!=="touch"){if(y==="x"){let z=_.clientX-w,b=Math.exp(z/200),C=Math.max(L.MIN_ZOOM,Math.min(L.MAX_ZOOM,n*b)),X=F.view.panX+0.5/n;F.view.zoomX=C,F.view.panX=X-0.5/C,u();return}else if(y==="y"){let z=w-_.clientY,b=Math.exp(z/200),C=Math.max(L.MIN_ZOOM,Math.min(L.MAX_ZOOM,n*b)),X=F.view.panY+0.5/n;F.view.zoomY=C,F.view.panY=X-0.5/C,u();return}}if(R==="pan"||F.dragging&&!y){let z=J.getBoundingClientRect(),b=(_.clientX-A)/z.width,C=(_.clientY-M)/z.height,X=performance.now();if(X-W<100)Y=Y*0.3+b*0.7,U=U*0.3+C*0.7;if(W=X,F.zoomMode!=="none"&&(F.zoomMode==="both"||F.zoomMode==="x-only"))F.view.panX-=b/F.view.zoomX;if(F.zoomMode!=="none"&&(F.zoomMode==="both"||F.zoomMode==="y-only"))F.view.panY+=C/F.view.zoomY;A=_.clientX,M=_.clientY,u()}}else if(Q.length===2&&R==="pinch"){if(_.pointerType==="touch")_.preventDefault();let Z=Q[1].clientX-Q[0].clientX,z=Q[1].clientY-Q[0].clientY,C=Math.hypot(Z,z)-m,X=Math.exp(C/300);if(F.zoomMode!=="none"&&(F.zoomMode==="both"||F.zoomMode==="x-only")){let p=Math.max(L.MIN_ZOOM,Math.min(L.MAX_ZOOM,o*X)),$0=F.view.panX+D/o;F.view.zoomX=p,F.view.panX=$0-D/p}if(F.zoomMode!=="none"&&(F.zoomMode==="both"||F.zoomMode==="y-only")){let p=Math.max(L.MIN_ZOOM,Math.min(L.MAX_ZOOM,v*X)),$0=F.view.panY+l/v;F.view.zoomY=p,F.view.panY=$0-l/p}u()}},{passive:!1,signal:N.signal});let s=(_)=>{if(Q=Q.filter((T)=>T.pointerId!==_.pointerId),J.releasePointerCapture(_.pointerId),k)clearTimeout(k),k=null;if(Q.length===0){let Z=Math.hypot(_.clientX-B,_.clientY-H)<S&&R!=="pan";if(Z&&_.pointerType==="touch"){let z=Date.now();if(z-P<300)V.resetView(F.id),P=0;else P=z}if(Z&&_.pointerType!=="touch"){let z=Date.now();if(z-P<300)V.resetView(F.id),P=0;else P=z}if(R==="pan"&&(Math.abs(Y)>0.001||Math.abs(U)>0.001))t();R="none",F.dragging=!1,y=null}else if(Q.length===1)R="detecting",B=Q[0].clientX,H=Q[0].clientY,A=Q[0].clientX,M=Q[0].clientY};J.addEventListener("pointerup",s,{signal:N.signal}),J.addEventListener("pointercancel",s,{signal:N.signal}),J.addEventListener("wheel",(_)=>{if(_.preventDefault(),F.momentum)cancelAnimationFrame(F.momentum),F.momentum=null;let T=J.getBoundingClientRect(),Z=_.clientX-T.left,z=_.clientY-T.top,b=Z/T.width,C=1-z/T.height,X=1-_.deltaY*0.002,p=L.MARGIN,$0=Z<p.left,P0=z>T.height-p.bottom,G0,q0;if($0)G0=!1,q0=!0;else if(P0)G0=!0,q0=!1;else G0=F.zoomMode==="both"||F.zoomMode==="x-only",q0=F.zoomMode==="both"||F.zoomMode==="y-only";if(G0){let V0=F.view.panX+b/F.view.zoomX;F.view.zoomX=Math.max(L.MIN_ZOOM,Math.min(L.MAX_ZOOM,F.view.zoomX*X)),F.view.panX=V0-b/F.view.zoomX}if(q0){let V0=F.view.panY+C/F.view.zoomY;F.view.zoomY=Math.max(L.MIN_ZOOM,Math.min(L.MAX_ZOOM,F.view.zoomY*X)),F.view.panY=V0-C/F.view.zoomY}if(G0||q0)u()},{passive:!1,signal:N.signal})},uninstall(F){let J=q.get(F);if(J){if(F.momentum)cancelAnimationFrame(F.momentum),F.momentum=null;J.el.style.touchAction=J.originalTouchAction,J.el.style.userSelect=J.originalUserSelect,J.el.style.webkitUserSelect=J.originalWebkitUserSelect,J.abort.abort(),q.delete(F)}}}}var E0=new WeakMap,b0=($,G,q,F,J,j,E,K)=>{$.beginPath(),$.roundRect(G,q,F,J,j),$.fillStyle=E,$.fill(),$.strokeStyle=K,$.lineWidth=1.5,$.stroke()},Z0={name:"hover",install($,G){let q=L.getInstance(),F=new AbortController,J={hoverResult:null,pillX:0,pillY:0,pillTargetX:0,pillTargetY:0,pillAnimRef:null,abort:F};E0.set($,J);let j=(K)=>{if($.config.onHover)$.config.onHover(K);if(!($.config.showTooltip??!1))return;if(J.hoverResult=K,q.drawChart($),K&&!J.pillAnimRef){let V=performance.now(),N=(O)=>{if(!J.hoverResult)return J.pillAnimRef=null;let Q=1-Math.pow(0.5,(O-V)/($.config.pillDecayMs??60));V=O,J.pillX+=(J.pillTargetX-J.pillX)*Q,J.pillY+=(J.pillTargetY-J.pillY)*Q,q.drawChart($),J.pillAnimRef=requestAnimationFrame(N)};J.pillAnimRef=requestAnimationFrame(N)}},E=(K,V)=>{if($.dragging)return;let N=G.getBoundingClientRect();j($.findNearestPoint(K-N.left,V-N.top,N.width,N.height))};G.addEventListener("mousemove",(K)=>E(K.clientX,K.clientY),{signal:F.signal}),G.addEventListener("touchmove",(K)=>{if(K.touches.length===1)E(K.touches[0].clientX,K.touches[0].clientY)},{signal:F.signal,passive:!0}),["mouseleave","pointerdown","touchend","touchcancel"].forEach((K)=>G.addEventListener(K,()=>j(null),{signal:F.signal}))},afterDraw($,G){let q=E0.get(G);if(!q?.hoverResult||!G.config.showTooltip)return;let{hoverResult:F}=q,J=G.width,j=G.height,E=L.MARGIN,K=L.getInstance().isDark,{formatX:V=String,formatY:N=String,fontFamily:O=L.DEFAULT_FONT}=G.config,Q=(G.bounds.maxX-G.bounds.minX)/G.view.zoomX,R=(G.bounds.maxY-G.bounds.minY)/G.view.zoomY,B=(F.x-(G.bounds.minX+G.view.panX*(G.bounds.maxX-G.bounds.minX)))/Q*J,H=j*(1-(F.y-(G.bounds.minY+G.view.panY*(G.bounds.maxY-G.bounds.minY)))/R),A=G.series[F.seriesIndex]||G.series[0],M=`${Math.round(A.color.r*255)},${Math.round(A.color.g*255)},${Math.round(A.color.b*255)}`,W=`rgb(${M})`,f=K?`oklch(from ${W} calc(l + 0.1) c h)`:W;$.save(),$.setLineDash([4,3]),$.strokeStyle=`rgba(${M},0.4)`,$.stroke(new Path2D(`M${B} 0V${j-E.bottom}M${E.left} ${H}H${J}`)),$.restore(),$.beginPath(),$.arc(B,H,4.5,0,Math.PI*2),$.fillStyle=W,$.fill(),$.strokeStyle=K?"rgba(0,0,0,0.6)":"rgba(255,255,255,0.9)",$.stroke();let S=G.series.map((U)=>{let P=0,y=U.rawX.length-1;while(P<=y){let w=P+y>>1;if(Math.abs(U.rawX[w]-F.x)<0.0001)return{label:U.label,val:N(U.rawY[w]),rawVal:U.rawY[w],col:`rgb(${Math.round(U.color.r*255)},${Math.round(U.color.g*255)},${Math.round(U.color.b*255)})`};U.rawX[w]<F.x?P=w+1:y=w-1}return null}).filter(Boolean);S.sort((U,P)=>Math.abs(P.rawVal)-Math.abs(U.rawVal));let d=S.length,k=S.slice(0,5),m=d-k.length;if(q.pillTargetX=B,q.pillTargetY=H,!q.pillAnimRef)q.pillX=B,q.pillY=H;let o=(U,P,y,w)=>{$.font=`600 10px ${O}`;let n=$.measureText(y).width,u=n+12,t=18,s=w?U-u/2:U-u,_=w?P:P-t/2;$.save();let T=w?Math.atan((q.pillTargetX-q.pillX)/80)*0.2:Math.atan((q.pillTargetY-q.pillY)/80)*0.2;$.translate(U,P),$.rotate(T);let Z=w?-u/2:-u,z=w?0:-t/2;$.beginPath(),$.roundRect(Z,z,u,t,4),$.fillStyle=K?"rgba(0,0,0,0.75)":"rgba(255,255,255,0.75)",$.fill(),$.fillStyle=`rgba(${M},0.2)`,$.fill(),$.strokeStyle=f,$.lineWidth=1.5,$.stroke(),$.fillStyle=f,$.textAlign="center",$.textBaseline="middle",$.fillText(y,Z+u/2,z+t/2),$.restore()};o(Math.max(E.left,Math.min(J-E.right,q.pillX)),j-E.bottom+4,V(F.x),!0),o(Math.max(E.left,E.left),Math.max(9,Math.min(j-E.bottom-9,q.pillY)),N(F.y),!1);let v=Math.max(...k.map((U)=>$.measureText(U.label+U.val).width))+40,D=30+k.length*18+(m>0?18:0),l=F.screenX+14,Y=F.screenY-D-6;if(l+v>J)l=F.screenX-v-14;if(Y=Math.max(4,Math.min(j-D-4,F.screenY-D-6)),b0($,l,Y,v,D,6,K?"rgba(28,28,30,0.95)":"rgba(255,255,255,0.96)","rgba(0,0,0,0.08)"),$.textAlign="left",$.textBaseline="middle",$.fillStyle=K?"#888":"#999",$.fillText(V(F.x),l+10,Y+15),k.forEach((U,P)=>{let y=Y+35+P*18;$.fillStyle=U.col,$.beginPath(),$.roundRect(l+10,y-4,8,8,2),$.fill(),$.fillStyle=K?"#eee":"#1a1a1a",$.fillText(`${U.label}: ${U.val}`,l+24,y)}),m>0){let U=Y+35+k.length*18;$.fillStyle=K?"#666":"#aaa",$.fillText(`+${m} more`,l+10,U)}},uninstall($){let G=E0.get($);if(G?.pillAnimRef)cancelAnimationFrame(G.pillAnimRef);G?.abort.abort(),E0.delete($)}};J0(H0);J0(z0());J0(Z0);var I,a=document.documentElement.classList.contains("dark"),T0=1,R0=null,O0=!1,k0,M0,f0,g=[],c=[],r=[],e=[],_0=null,B0=null,L0=null;function X0($,G,q){let F=(1-Math.abs(2*q-1))*G,J=F*(1-Math.abs($/60%2-1)),j=q-F/2,E=0,K=0,V=0;if($<60)E=F,K=J;else if($<120)E=J,K=F;else if($<180)K=F,V=J;else if($<240)K=J,V=F;else if($<300)E=J,V=F;else E=F,V=J;return{r:E+j,g:K+j,b:V+j}}function j0(){return X0(Math.random()*360,0.65+Math.random()*0.2,0.5+Math.random()*0.1)}var D0=new Date("2026-02-03");function h($){if($>=1000)return"$"+($/1000).toFixed(1)+"k";if($>=100)return"$"+$.toFixed(0);if($>=10)return"$"+$.toFixed(1);return"$"+$.toFixed(2)}function K0($){let G=D0.getTime()-Math.round($)*60000,q=new Date(G),J=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"][q.getMonth()],j=q.getDate(),E=q.getFullYear();return`${J} ${j}, ${E}`}function N0($){if(Math.abs($)>=1000)return($/1000).toFixed(1)+"k";if(Math.abs($)>=100)return $.toFixed(0);if(Math.abs($)>=10)return $.toFixed(1);return $.toFixed(2)}function i($){return Math.round($).toString()}function x($,G){let q=new Array($),F=new Array($);if(G==="stock")for(let E=0;E<$;E++)q[E]=$-1-E;else for(let E=0;E<$;E++)q[E]=E;let j=2*Math.PI;switch(G){case"stock":{let K=Math.LN2/5258880,V=-K*3,N=0.0005,O=0.0009000000000000001,Q=$/5258880,R=Math.max(1,Math.round(Q*(0.8+Math.random()*0.4))),B=[];for(let f=0;f<R;f++){let S=Math.floor(Math.random()*$*0.9),d=Math.floor((180+Math.random()*360)*1440);B.push({s:S,e:S+d})}B.sort((f,S)=>f.s-S.s);let H=Math.log(10+Math.random()*20),A=0,M=0,W=!1;for(let f=0;f<$;f++){while(A<B.length&&f>=B[A].e)A++;let S=A<B.length&&f>=B[A].s&&f<B[A].e,d=S?V:K,k=S?0.0009000000000000001:0.0005,m;if(W)m=M,W=!1;else{let o=Math.random()||0.0000000001,v=Math.sqrt(-2*Math.log(o)),D=j*Math.random();m=v*Math.cos(D),M=v*Math.sin(D),W=!0}H+=d+k*m,F[f]=Math.exp(H)}break}case"trending":{let E=Math.log(20+Math.random()*20),K=Math.LN2/$,V=0.015,N=0,O=!1;for(let Q=0;Q<$;Q++){let R;if(O)R=N,O=!1;else{let B=Math.random()||0.0000000001,H=Math.sqrt(-2*Math.log(B)),A=j*Math.random();R=H*Math.cos(A),N=H*Math.sin(A),O=!0}E+=K+V*R,F[Q]=Math.exp(E)}break}case"declining":{let E=Math.log(60+Math.random()*40),K=-Math.LN2/$,V=0.015,N=0,O=!1;for(let Q=0;Q<$;Q++){let R;if(O)R=N,O=!1;else{let B=Math.random()||0.0000000001,H=Math.sqrt(-2*Math.log(B)),A=j*Math.random();R=H*Math.cos(A),N=H*Math.sin(A),O=!0}E+=K+V*R,F[Q]=Math.exp(E)}break}case"spikey":{let E=20+Math.random()*30,K=3+Math.floor(Math.random()*5),V=new Set;while(V.size<Math.min(K,$))V.add(Math.floor(Math.random()*$));let N=E*1.2,O=E*5;for(let Q=0;Q<$;Q++)if(V.has(Q))F[Q]=Math.random()<0.5?-O:O;else F[Q]=(Math.random()-0.5)*N;break}case"cyclic":{let E=Date.now()%1e5/1e5*j,K=30+Math.random()*20,V=50+Math.random()*20,N=2+Math.random()*4,O=j*N/$,Q=K*0.25;for(let R=0;R<$;R++){let B=R*O+E;F[R]=V+Math.sin(B)*K+Math.sin(B*2.7+1.3)*Q+(Math.random()-0.5)*8}break}}return{x:q,y:F}}async function u0(){if(I=L.getInstance(),!await I.init()){alert("WebGPU not available. Please use a supported browser.");return}o0(),m0(),v0(),p0(),g0(),x0(),d0()}function m0(){let $=x(25,"trending");I.create({type:"bar",container:document.getElementById("basic-bar"),series:[{label:"Revenue",color:{r:0.6,g:0.4,b:0.9},x:$.x,y:$.y}],formatX:i,formatY:h,showTooltip:!0});let G=x(1000,"trending"),q=G.x.map((J,j)=>999-j);I.create({type:"line",container:document.getElementById("basic-line"),series:[{label:"Stock Price",color:{r:0.3,g:0.6,b:1},x:q,y:G.y}],formatX:K0,formatY:h,showTooltip:!0});let F=x(5000,"cyclic");I.create({type:"scatter",container:document.getElementById("basic-scatter"),series:[{label:"Cyclic Data",color:{r:1,g:0.4,b:0.4},x:F.x,y:F.y}],formatX:i,formatY:N0,showTooltip:!0})}function v0(){let $=[],G=x(25,"trending"),q=[1,0.7,1.3];for(let j=0;j<3;j++){let E=x(25,"trending"),K=E.y.map((V)=>V*q[j]);$.push({label:`Series ${j+1}`,color:j0(),x:E.x,y:K})}I.create({type:"bar",container:document.getElementById("series-bar"),series:$,formatX:i,formatY:h,showTooltip:!0});let F=[];for(let j=0;j<3;j++){let E=x(1000,"trending"),K=E.x.map((V,N)=>999-N);F.push({label:`Series ${j+1}`,color:j0(),x:K,y:E.y})}I.create({type:"line",container:document.getElementById("series-line"),series:F,formatX:K0,formatY:h,showTooltip:!0});let J=[];for(let j=0;j<3;j++){let E=x(5000,"cyclic");J.push({label:`Series ${j+1}`,color:j0(),x:E.x,y:E.y})}I.create({type:"scatter",container:document.getElementById("series-scatter"),series:J,formatX:i,formatY:N0,showTooltip:!0})}function p0(){let $=x(1e5,"spikey");I.create({type:"line",container:document.getElementById("spikes-line"),series:[{label:"Volatile Data",color:{r:1,g:0.5,b:0.2},x:$.x,y:$.y}],formatX:i,formatY:N0,showTooltip:!0})}function g0(){let $=x(100,"trending"),G=x(100,"trending"),q=x(100,"trending");g=Array.from({length:100},(j,E)=>E),c=[...$.y],r=[...G.y],e=[...q.y],k0=I.create({type:"line",container:document.getElementById("live-line"),series:[{label:"Live Data",color:{r:0.2,g:0.8,b:0.4},x:[...g],y:[...c]}],formatX:i,formatY:h,showTooltip:!0}),M0=I.create({type:"scatter",container:document.getElementById("live-scatter"),series:[{label:"Live Data",color:{r:0.9,g:0.3,b:0.7},x:[...g],y:[...r]}],formatX:i,formatY:h,showTooltip:!0}),f0=I.create({type:"line",container:document.getElementById("live-line2"),series:[{label:"Live Data",color:{r:0.4,g:0.5,b:1},x:[...g],y:[...e]}],formatX:i,formatY:h,showTooltip:!0});let F=document.querySelectorAll(".speed-btn");F.forEach((j)=>{j.addEventListener("click",()=>{F.forEach((E)=>E.classList.remove("active")),j.classList.add("active"),T0=parseInt(j.dataset.speed),W0()})});let J=document.getElementById("accumulate-toggle");J.addEventListener("change",()=>{O0=J.checked}),W0()}function W0(){if(R0!==null)clearInterval(R0);let $=1000/T0;R0=window.setInterval(()=>{let G=g.length>0?g[g.length-1]+1:0,q=c.length>0?c[c.length-1]:50,F=r.length>0?r[r.length-1]:50,J=e.length>0?e[e.length-1]:50;if(g.push(G),c.push(q+(Math.random()-0.5)*5),r.push(F+(Math.random()-0.5)*8),e.push(J+(Math.random()-0.5)*6),!O0&&g.length>500)g.shift(),c.shift(),r.shift(),e.shift();I.updateSeries(k0,[{label:"Live Data",color:{r:0.2,g:0.8,b:0.4},x:[...g],y:[...c]}]),I.updateSeries(M0,[{label:"Live Data",color:{r:0.9,g:0.3,b:0.7},x:[...g],y:[...r]}]),I.updateSeries(f0,[{label:"Live Data",color:{r:0.4,g:0.5,b:1},x:[...g],y:[...e]}]);let j=O0?"Accumulate":"Ring Buffer";document.getElementById("live-stats").textContent=`Points: ${g.length} (${j})`},$)}function x0(){let $=document.getElementById("bigdata-generate"),G=document.getElementById("bigdata-count"),q=document.getElementById("bigdata-stats");$.addEventListener("click",()=>{let F=parseInt(G.value)||1e6;$.setAttribute("disabled","true"),q.textContent="Generating...",setTimeout(()=>{let J=performance.now();if(_0)I.destroy(_0);if(B0)I.destroy(B0);let j=x(F,"stock"),E=x(F,"cyclic");_0=I.create({type:"line",container:document.getElementById("bigdata-line"),series:[{label:"Big Data",color:{r:0.3,g:0.7,b:0.9},x:j.x,y:j.y}],formatX:K0,formatY:h,showTooltip:!0}),B0=I.create({type:"scatter",container:document.getElementById("bigdata-scatter"),series:[{label:"Big Data",color:{r:0.9,g:0.5,b:0.3},x:E.x,y:E.y}],formatX:i,formatY:N0,showTooltip:!0});let K=performance.now()-J,V=(F/1e6).toFixed(1)+"M";document.getElementById("bigdata-line-info").textContent=V,document.getElementById("bigdata-scatter-info").textContent=V,q.textContent=`Generated in ${K.toFixed(0)}ms`,$.removeAttribute("disabled")},50)})}function d0(){let $=document.getElementById("bigseries-generate"),G=document.getElementById("bigseries-series"),q=document.getElementById("bigseries-points"),F=document.getElementById("bigseries-stats");$.addEventListener("click",()=>{let J=parseInt(G.value)||1000,j=parseInt(q.value)||1000;$.setAttribute("disabled","true"),F.textContent="Generating...",setTimeout(()=>{let E=performance.now();if(L0)I.destroy(L0);let K=[];for(let Q=0;Q<J;Q++){let R=x(j,"trending"),B=R.x.map((H,A)=>j-1-A);K.push({label:`S${Q+1}`,color:j0(),x:B,y:R.y})}L0=I.create({type:"line",container:document.getElementById("bigseries-line"),series:K,formatX:K0,formatY:h,showTooltip:!0});let V=performance.now()-E,N=J*j,O=N>=1e6?(N/1e6).toFixed(1)+"M":(N/1000).toFixed(0)+"k";document.getElementById("bigseries-info").textContent=`${J} series Ã— ${j} pts = ${O} total`,F.textContent=`Generated in ${V.toFixed(0)}ms`,$.removeAttribute("disabled")},50)})}function o0(){let $=document.getElementById("theme-btn"),G=document.getElementById("theme-icon-sun"),q=document.getElementById("theme-icon-moon"),F=()=>{G.style.display=a?"none":"block",q.style.display=a?"block":"none"};F(),$.addEventListener("click",()=>{a=!a,document.documentElement.classList.toggle("dark",a),localStorage.setItem("theme",a?"dark":"light"),I.setTheme(a),F()})}u0();
